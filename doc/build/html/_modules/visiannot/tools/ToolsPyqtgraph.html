

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>visiannot.tools.ToolsPyqtgraph &mdash; ViSiAnnoT 0.2.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> ViSiAnnoT
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide-visiannot.html">User guide: ViSiAnnoT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide-configuration.html">User guide: configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide-toolspyqt.html">User guide: ToolsPyQt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide-toolspyqtgraph.html">User guide: ToolsPyqtgraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../exe.html">Creating a standalone executable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software.html">Software description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../further.html">Further developments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../APIreference/index.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ViSiAnnoT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>visiannot.tools.ToolsPyqtgraph</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for visiannot.tools.ToolsPyqtgraph</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#</span>
<span class="c1"># Copyright Universit√© Rennes 1</span>
<span class="c1"># Contributor: Raphael Weber</span>
<span class="c1">#</span>
<span class="c1"># Under CeCILL license</span>
<span class="c1"># http://www.cecill.info</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module with sub-classes and functions for scientific graphics with pyqtgraph</span>

<span class="sd">See https://pyqtgraph.readthedocs.io/en/latest</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">pyqtgraph</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="k">import</span> <span class="n">QtCore</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="k">import</span> <span class="n">QFont</span><span class="p">,</span> <span class="n">QSizePolicy</span>
<span class="kn">from</span> <span class="nn">.ToolsPyQt</span> <span class="k">import</span> <span class="n">createWindow</span><span class="p">,</span> <span class="n">addWidgetToLayout</span><span class="p">,</span> <span class="n">initializeDisplay</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="c1"># *************************************************************************** #</span>
<span class="c1"># *************************************************************************** #</span>
<span class="c1"># ************************** Pyqtgraph subclass ***************************** #</span>
<span class="c1"># *************************************************************************** #</span>
<span class="c1"># *************************************************************************** #</span>

<div class="viewcode-block" id="PlotItemCustom"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.PlotItemCustom">[docs]</a><span class="k">class</span> <span class="nc">PlotItemCustom</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">graphicsItems</span><span class="o">.</span><span class="n">PlotItem</span><span class="o">.</span><span class="n">PlotItem</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Subclass of **pyqtgraph.graphicsItems.PlotItem.PlotItem** so that the</span>
<span class="sd">    effect of &quot;auto-range&quot; button is applied only on Y axis</span>

<span class="sd">    The method autoBtnClicked is re-implemented.</span>

<span class="sd">    See https://pyqtgraph.readthedocs.io/en/latest/graphicsItems/plotitem.html</span>
<span class="sd">    for details.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PlotItemCustom.autoBtnClicked"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.PlotItemCustom.autoBtnClicked">[docs]</a>    <span class="k">def</span> <span class="nf">autoBtnClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Re-implemented</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">enableAutoRange</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SignalWidget"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.SignalWidget">[docs]</a><span class="k">class</span> <span class="nc">SignalWidget</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">PlotWidget</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Subclass of **pyqtgraph.PlotWidget** so that he effect of &quot;auto-range&quot;</span>
<span class="sd">        button is applied only on Y axis</span>

<span class="sd">        The constructor is re-implemented so that a PlotItemCustom instance is</span>
<span class="sd">        used as the central item of the widget.</span>

<span class="sd">        See https://pyqtgraph.readthedocs.io/en/latest/widgets/plotwidget.html</span>
<span class="sd">        for details about parent class.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pg</span><span class="o">.</span><span class="n">GraphicsView</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">background</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enableMouse</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotItem</span> <span class="o">=</span> <span class="n">PlotItemCustom</span><span class="p">(</span><span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setCentralItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotItem</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s1">&#39;addItem&#39;</span><span class="p">,</span> <span class="s1">&#39;removeItem&#39;</span><span class="p">,</span> <span class="s1">&#39;autoRange&#39;</span><span class="p">,</span> <span class="s1">&#39;clear&#39;</span><span class="p">,</span> <span class="s1">&#39;setXRange&#39;</span><span class="p">,</span>
            <span class="s1">&#39;setYRange&#39;</span><span class="p">,</span> <span class="s1">&#39;setRange&#39;</span><span class="p">,</span> <span class="s1">&#39;setAspectLocked&#39;</span><span class="p">,</span> <span class="s1">&#39;setMouseEnabled&#39;</span><span class="p">,</span>
            <span class="s1">&#39;setXLink&#39;</span><span class="p">,</span> <span class="s1">&#39;setYLink&#39;</span><span class="p">,</span> <span class="s1">&#39;enableAutoRange&#39;</span><span class="p">,</span> <span class="s1">&#39;disableAutoRange&#39;</span><span class="p">,</span>
            <span class="s1">&#39;setLimits&#39;</span><span class="p">,</span> <span class="s1">&#39;register&#39;</span><span class="p">,</span> <span class="s1">&#39;unregister&#39;</span><span class="p">,</span> <span class="s1">&#39;viewRect&#39;</span>
        <span class="p">]:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotItem</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotItem</span><span class="o">.</span><span class="n">sigRangeChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">viewRangeChanged</span><span class="p">)</span></div>


<div class="viewcode-block" id="ProgressWidget"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.ProgressWidget">[docs]</a><span class="k">class</span> <span class="nc">ProgressWidget</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">PlotWidget</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">nframes</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">progress_style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;brush&#39;</span><span class="p">:</span> <span class="s1">&#39;#F00&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span>
        <span class="n">bg_progress_style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pen&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}},</span>
        <span class="n">line_style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
        <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#000&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="s1">&#39;9pt&#39;</span><span class="p">},</span>
        <span class="n">ticks_color</span><span class="o">=</span><span class="s2">&quot;#000&quot;</span><span class="p">,</span> <span class="n">ticks_size</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">ticks_offset</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Subclass of **pyqtgraph.PlotWidget** that defines the widget used as a</span>
<span class="sd">        progression bar for video/signal navigation in :class:`.ViSiAnnoT`</span>
<span class="sd">        window</span>

<span class="sd">        See https://pyqtgraph.readthedocs.io/en/latest/widgets/plotwidget.html</span>
<span class="sd">        for details about parent class.</span>

<span class="sd">        The constructor is re-implemented. It calls the constructor of</span>
<span class="sd">        PlotWidget and adds new attributes.</span>

<span class="sd">        NB: attributes have the prefix _, so one should use the get methods to</span>
<span class="sd">        access them.</span>

<span class="sd">        :param nframes: number of frames in the progress bar</span>
<span class="sd">        :type nframes: int</span>
<span class="sd">        :param parent: see</span>
<span class="sd">            https://pyqtgraph.readthedocs.io/en/latest/widgets/plotwidget.html</span>
<span class="sd">        :param progress_style: plot style of the sliding progression point</span>
<span class="sd">        :type progress_style: dict</span>
<span class="sd">        :param bg_progress_style: plot style of the background progression bar</span>
<span class="sd">        :type bg_progress_style: dict</span>
<span class="sd">        :param line_style: plot style of the current temporal range bounds</span>
<span class="sd">        :type line_style: dict</span>
<span class="sd">        :param title: progress bar title</span>
<span class="sd">        :type title: str</span>
<span class="sd">        :param title_style: title style</span>
<span class="sd">        :type title_style: dict</span>
<span class="sd">        :param ticks_color: color of the ticks text in HEX string or RGB format</span>
<span class="sd">        :type ticks_color: str or tuple</span>
<span class="sd">        :param ticks_size: font size of the ticks text in pt</span>
<span class="sd">        :type ticks_size: float or int</span>
<span class="sd">        :param ticks_offset: ticks text offset</span>
<span class="sd">        :type ticks_offset: int</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># PlotWidget initialization</span>
        <span class="n">pg</span><span class="o">.</span><span class="n">PlotWidget</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

        <span class="c1"># input attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nframes</span> <span class="o">=</span> <span class="n">nframes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dragged</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># add background bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_progress_curve</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">PlotCurveItem</span><span class="p">(</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nframes</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">bg_progress_style</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_progress_curve</span><span class="p">)</span>

        <span class="c1"># add sliding progress point</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_progress_plot</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">ScatterPlotItem</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">progress_style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_progress_plot</span><span class="p">)</span>

        <span class="c1"># add infinite lines for first and last frames</span>
        <span class="c1"># (position not initialized)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_first_line</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">InfiniteLine</span><span class="p">(</span><span class="n">pen</span><span class="o">=</span><span class="n">line_style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_first_line</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_line</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">InfiniteLine</span><span class="p">(</span><span class="n">pen</span><span class="o">=</span><span class="n">line_style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_line</span><span class="p">)</span>

        <span class="c1"># disable default mouse interaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMouseEnabled</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hideButtons</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMenuEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># no Y axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showAxis</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># set X axis ticks style</span>
        <span class="n">setTicksTextStyle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getAxis</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">ticks_color</span><span class="p">,</span>
                          <span class="n">size</span><span class="o">=</span><span class="n">ticks_size</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">ticks_offset</span><span class="p">)</span>

        <span class="c1"># set title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">title_style</span><span class="p">)</span>


<div class="viewcode-block" id="ProgressWidget.getNFrames"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.ProgressWidget.getNFrames">[docs]</a>    <span class="k">def</span> <span class="nf">getNFrames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get method for attribute nframes</span>

<span class="sd">        :returns: number of frames</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nframes</span></div>


<div class="viewcode-block" id="ProgressWidget.getProgressCurve"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.ProgressWidget.getProgressCurve">[docs]</a>    <span class="k">def</span> <span class="nf">getProgressCurve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get method for attribute progress_curve</span>

<span class="sd">        :returns: background progression bar</span>
<span class="sd">        :rtype: pyqtgraph.PlotCurveItem</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_progress_curve</span></div>


<div class="viewcode-block" id="ProgressWidget.getDragged"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.ProgressWidget.getDragged">[docs]</a>    <span class="k">def</span> <span class="nf">getDragged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get method for attribute dragged</span>

<span class="sd">        :returns: specify if the sliding progress point is dragged</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dragged</span></div>


<div class="viewcode-block" id="ProgressWidget.getProgressPlot"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.ProgressWidget.getProgressPlot">[docs]</a>    <span class="k">def</span> <span class="nf">getProgressPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get method for attribute progress_plot</span>

<span class="sd">        :returns: sliding progress point</span>
<span class="sd">        :rtype: pyqtgraph.ScatterPlotItem</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_progress_plot</span></div>


<div class="viewcode-block" id="ProgressWidget.getFirstLine"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.ProgressWidget.getFirstLine">[docs]</a>    <span class="k">def</span> <span class="nf">getFirstLine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get method for attribute first_line</span>

<span class="sd">        :returns: start boundary of the current temporal range in the</span>
<span class="sd">            associated :class:`.ViSiAnnoT` window</span>
<span class="sd">        :rtype: pyqtgraph.InfiniteLine</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_line</span></div>


<div class="viewcode-block" id="ProgressWidget.getLastLine"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.ProgressWidget.getLastLine">[docs]</a>    <span class="k">def</span> <span class="nf">getLastLine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get method for attribute first_line</span>

<span class="sd">        :returns: end boundary of the current temporal range in the associated</span>
<span class="sd">            :class:`.ViSiAnnoT` window</span>
<span class="sd">        :rtype: pyqtgraph.InfiniteLine</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_line</span></div>


<div class="viewcode-block" id="ProgressWidget.getMouseXPosition"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.ProgressWidget.getMouseXPosition">[docs]</a>    <span class="k">def</span> <span class="nf">getMouseXPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the position of the mouse on the X axis in the progress plot</span>
<span class="sd">        coordinates</span>

<span class="sd">        :param ev: emitted when the mouse is clicked/moved</span>
<span class="sd">        :type ev: QtGui.QMouseEvent</span>

<span class="sd">        :returns: position of the mouse</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getViewBox</span><span class="p">()</span><span class="o">.</span><span class="n">mapToView</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span><span class="o">.</span><span class="n">x</span><span class="p">()</span></div>


<div class="viewcode-block" id="ProgressWidget.updateNFrames"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.ProgressWidget.updateNFrames">[docs]</a>    <span class="k">def</span> <span class="nf">updateNFrames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nframes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets a new value for the number of frames in the progress bar</span>

<span class="sd">        :param nframes: new number of frames in the progress bar</span>
<span class="sd">        :type nframes: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_nframes</span> <span class="o">=</span> <span class="n">nframes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_progress_curve</span><span class="o">.</span><span class="n">setData</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nframes</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span></div>


<div class="viewcode-block" id="ProgressWidget.mousePressEvent"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.ProgressWidget.mousePressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Re-implemented in order to set the new position of the sliding</span>
<span class="sd">        progression point and launch the mouse dragging</span>

<span class="sd">        :param ev: emitted when the mouse is clicked/moved</span>
<span class="sd">        :type ev: QtGui.QMouseEvent</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># check if left button is clicked and dragging not launched</span>
        <span class="k">if</span> <span class="n">ev</span><span class="o">.</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dragged</span><span class="p">:</span>
            <span class="c1"># get mouse position on the X axis</span>
            <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMouseXPosition</span><span class="p">(</span><span class="n">ev</span><span class="p">)</span>

            <span class="c1"># check boundaries</span>
            <span class="k">if</span> <span class="n">position</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">position</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nframes</span><span class="p">:</span>
                <span class="c1"># set new position of the sliding progress point</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_progress_plot</span><span class="o">.</span><span class="n">setData</span><span class="p">([</span><span class="n">position</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>

                <span class="c1"># launch dragging</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dragged</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="ProgressWidget.mouseMoveEvent"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.ProgressWidget.mouseMoveEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mouseMoveEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Re-implemented in order to set the new position of the sliding</span>
<span class="sd">        progression point while dragging</span>

<span class="sd">        :param ev: emitted when the mouse is clicked/moved</span>
<span class="sd">        :type ev: QtGui.QMouseEvent</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># check if dragging is launched</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dragged</span><span class="p">:</span>
            <span class="c1"># get mouse position on the X axis</span>
            <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMouseXPosition</span><span class="p">(</span><span class="n">ev</span><span class="p">)</span>

            <span class="c1"># check boundaries</span>
            <span class="k">if</span> <span class="n">position</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">position</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nframes</span><span class="p">:</span>
                <span class="c1"># set new position of the sliding progress point</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_progress_plot</span><span class="o">.</span><span class="n">setData</span><span class="p">([</span><span class="n">position</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>


<div class="viewcode-block" id="ProgressWidget.mouseReleaseEvent"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.ProgressWidget.mouseReleaseEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mouseReleaseEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Re-implemented in order to set the new position of the sliding</span>
<span class="sd">        progression point and terminate the mouse dragging</span>

<span class="sd">        :param ev: emitted when the mouse is clicked/moved</span>
<span class="sd">        :type ev: QtGui.QMouseEvent</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># check if left button release and if dragging is launched</span>
        <span class="k">if</span> <span class="n">ev</span><span class="o">.</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dragged</span><span class="p">:</span>
            <span class="c1"># get mouse position on the X axis</span>
            <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMouseXPosition</span><span class="p">(</span><span class="n">ev</span><span class="p">)</span>

            <span class="c1"># check boundaries</span>
            <span class="k">if</span> <span class="n">position</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">position</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nframes</span><span class="p">:</span>
                <span class="c1"># set new position of the sliding progress point</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_progress_plot</span><span class="o">.</span><span class="n">setData</span><span class="p">([</span><span class="n">position</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="c1"># terminate dragging</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dragged</span> <span class="o">=</span> <span class="kc">False</span></div></div>


<span class="c1"># *************************************************************************** #</span>
<span class="c1"># *************************************************************************** #</span>
<span class="c1"># ***************************** Functions *********************************** #</span>
<span class="c1"># *************************************************************************** #</span>
<span class="c1"># *************************************************************************** #</span>

<div class="viewcode-block" id="setBackgroundColor"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.setBackgroundColor">[docs]</a><span class="k">def</span> <span class="nf">setBackgroundColor</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets background color of pyqtgraph widgets (independent of PyQt5 widgets)</span>

<span class="sd">    :param color: background color as a string or RGB</span>
<span class="sd">        (see https://pyqtgraph.readthedocs.io/en/latest/style.html for details)</span>
<span class="sd">    :type color: str or tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pg</span><span class="o">.</span><span class="n">setConfigOption</span><span class="p">(</span><span class="s1">&#39;background&#39;</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span></div>


<div class="viewcode-block" id="initializeDisplayAndBgColor"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.initializeDisplayAndBgColor">[docs]</a><span class="k">def</span> <span class="nf">initializeDisplayAndBgColor</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a Qt application for display and sets background color of the</span>
<span class="sd">    pyqtgraph widgets</span>

<span class="sd">    It calls the functions :func:`.ToolsPyQt.initializeDisplay` and</span>
<span class="sd">    :func:`.Toolspyqtgraph.setBackgroundColor`.</span>

<span class="sd">    :param color: background color as a string or RGB</span>
<span class="sd">        (see https://pyqtgraph.readthedocs.io/en/latest/style.html for details)</span>
<span class="sd">    :type color: str or tuple</span>

<span class="sd">    :returns: instance of QtCore.QCoreApplication or QtWidgets.QApplication</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">app</span> <span class="o">=</span> <span class="n">initializeDisplay</span><span class="p">()</span>
    <span class="n">setBackgroundColor</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">app</span></div>


<div class="viewcode-block" id="create2DWidget"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.create2DWidget">[docs]</a><span class="k">def</span> <span class="nf">create2DWidget</span><span class="p">(</span>
    <span class="n">lay</span><span class="p">,</span> <span class="n">widget_position</span><span class="p">,</span> <span class="n">widget_size</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">widget_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title_style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#0000&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="s1">&#39;9pt&#39;</span><span class="p">},</span>
    <span class="n">x_range</span><span class="o">=</span><span class="p">[],</span> <span class="n">y_range</span><span class="o">=</span><span class="p">[],</span> <span class="n">axes_label_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
    <span class="n">flag_invert_x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_invert_y</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_aspect_locked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">flag_plot_menu</span><span class="o">=</span><span class="kc">True</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a 2D widget and adds it to a grid layout</span>

<span class="sd">    The widget content is empty.</span>

<span class="sd">    :param lay: parent layout where the widget is added</span>
<span class="sd">    :type lay: QtWidgets.QGridLayout</span>
<span class="sd">    :param widget_position: position of the widget in the parent layout,</span>
<span class="sd">        length 2 ``(row, col)`` or 4 ``(row, col, rowspan, colspan)``</span>
<span class="sd">    :type widget_position: tuple</span>
<span class="sd">    :param widget_size: maximum size of the widget, length 2</span>
<span class="sd">        ``(width, height)``, set a value to 0 in order to have an automatic</span>
<span class="sd">        sizing in the corresponding axis</span>
<span class="sd">    :type widget_size: tuple</span>
<span class="sd">    :param widget_title: widget title, basic HTML allowed</span>
<span class="sd">    :type widget_title: str</span>
<span class="sd">    :param title_style: title style</span>
<span class="sd">    :type title_style: dict</span>
<span class="sd">    :param x_range: range values on the X axis, length 2 ``(x_min, x_max)``</span>
<span class="sd">    :type x_range: tuple</span>
<span class="sd">    :param y_range: range values on the Y axis, length 2 ``(y_min, y_max)``</span>
<span class="sd">    :type y_range: tuple</span>
<span class="sd">    :param axes_label_dict: axes to show and their respective label</span>

<span class="sd">        - Key is the axis identifier (``&quot;left&quot;``, ``&quot;right&quot;``,</span>
<span class="sd">          ``&quot;bottom&quot;`` or ``&quot;top&quot;``)</span>
<span class="sd">        - Value is the associated label as a list of length 2:</span>

<span class="sd">            - axis label (*str*)</span>
<span class="sd">            - label style (*dict*), e.g.</span>
<span class="sd">              ``{&#39;color&#39;: &#39;#000&#39;, &#39;font-size&#39;: &#39;10pt&#39;}``</span>
<span class="sd">        - In case no label is associated to the axis, set the corresponding</span>
<span class="sd">          value to ``None``</span>
<span class="sd">    :type axes_label_dict: dict</span>
<span class="sd">    :param flag_invert_x: specify if the X axis must be inverted</span>
<span class="sd">    :type flag_invert_x: bool</span>
<span class="sd">    :param flag_invert_y: specify if the Y axis must be inverted</span>
<span class="sd">    :type flag_invert_y: bool</span>
<span class="sd">    :param flag_aspect_locked: specify if the aspect ratio must be locked</span>
<span class="sd">    :type flag_aspect_locked: bool</span>
<span class="sd">    :param flag_plot_menu: specify if the plot menu is enabled</span>
<span class="sd">    :type flag_plot_menu: bool</span>

<span class="sd">    :returns: widget</span>
<span class="sd">    :rtype: pyqtgraph.PlotWidget</span>

<span class="sd">    :author: Raphael Weber</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># create the widget</span>
    <span class="n">widget</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">PlotWidget</span><span class="p">()</span>

    <span class="c1"># axes settings</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">showAxis</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">showAxis</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">label_info</span> <span class="ow">in</span> <span class="n">axes_label_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">showAxis</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label_info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label_info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">widget</span><span class="o">.</span><span class="n">getAxis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">label_info</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">widget</span><span class="o">.</span><span class="n">getAxis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span>
                    <span class="n">text</span><span class="o">=</span><span class="n">label_info</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">label_info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="p">)</span>

    <span class="c1"># invert axis</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flag_invert_x</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">invertX</span><span class="p">(</span><span class="n">flag_invert_x</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flag_invert_y</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">invertY</span><span class="p">(</span><span class="n">flag_invert_y</span><span class="p">)</span>

    <span class="c1"># set title</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="n">widget_title</span><span class="p">,</span> <span class="o">**</span><span class="n">title_style</span><span class="p">)</span>

    <span class="c1"># set the widget size</span>
    <span class="k">if</span> <span class="n">widget_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">widget_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="n">widget_size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">widget_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">widget_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="n">widget_size</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">widget_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">widget_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">widget_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">widget_size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># set aspect locked or not</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">setAspectLocked</span><span class="p">(</span><span class="n">flag_aspect_locked</span><span class="p">)</span>

    <span class="c1"># set plot menu</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">setMenuEnabled</span><span class="p">(</span><span class="n">flag_plot_menu</span><span class="p">)</span>

    <span class="c1"># set the range</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="ow">and</span> \
            <span class="nb">len</span><span class="p">(</span><span class="n">x_range</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setXRange</span><span class="p">(</span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">y_range</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_range</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="ow">and</span> \
            <span class="nb">len</span><span class="p">(</span><span class="n">y_range</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setYRange</span><span class="p">(</span><span class="n">y_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># add the widget to the layout</span>
    <span class="n">addWidgetToLayout</span><span class="p">(</span><span class="n">lay</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">widget_position</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">widget</span></div>


<div class="viewcode-block" id="createWidgetImage"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.createWidgetImage">[docs]</a><span class="k">def</span> <span class="nf">createWidgetImage</span><span class="p">(</span><span class="n">lay</span><span class="p">,</span> <span class="n">widget_position</span><span class="p">,</span> <span class="n">im</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">title_style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#000&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="s1">&#39;9pt&#39;</span><span class="p">}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a widget containing an image and adds it to a grid layout</span>

<span class="sd">    :param lay: parent layout where the widget is added</span>
<span class="sd">    :type lay: QtWidgets.QGridLayout</span>
<span class="sd">    :param widget_position: position of the widget in the parent layout, length</span>
<span class="sd">        2 ``(row, col)`` or 4 ``(row, col, rowspan, colspan)``</span>
<span class="sd">    :type widget_position: tuple</span>
<span class="sd">    :param im: RGB image array of shape :math:`(width, height, 3)`</span>
<span class="sd">    :type im: numpy array</span>
<span class="sd">    :param title: widget title</span>
<span class="sd">    :type title: str</span>
<span class="sd">    :param title_style: widget title style</span>
<span class="sd">    :type title_style: dict</span>

<span class="sd">    :returns:</span>
<span class="sd">        - **widget** (:class:`.ToolsPyqtgraph.PlotWidget`) -- image container</span>
<span class="sd">        - **img** (*pyqtgraph.ImageItem*) -- image item</span>

<span class="sd">    :author: Raphael Weber</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># create the widget</span>
    <span class="n">widget</span> <span class="o">=</span> <span class="n">create2DWidget</span><span class="p">(</span>
        <span class="n">lay</span><span class="p">,</span> <span class="n">widget_position</span><span class="p">,</span> <span class="n">widget_title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">title_style</span><span class="o">=</span><span class="n">title_style</span><span class="p">,</span>
        <span class="n">axes_label_dict</span><span class="o">=</span><span class="p">{},</span> <span class="n">flag_invert_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">flag_aspect_locked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">flag_plot_menu</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

    <span class="c1"># create image item and add it to the widget</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">ImageItem</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">widget</span><span class="p">,</span> <span class="n">img</span></div>


<div class="viewcode-block" id="createWidgetLogo"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.createWidgetLogo">[docs]</a><span class="k">def</span> <span class="nf">createWidgetLogo</span><span class="p">(</span><span class="n">lay</span><span class="p">,</span> <span class="n">widget_position</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">box_size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a widget with no mouse interaction containing an image and adds it</span>
<span class="sd">    to a grid layout</span>

<span class="sd">    :param lay: parent layout where the widget is added</span>
<span class="sd">    :type lay: QtWidgets.QGridLayout</span>
<span class="sd">       instance of QtWidgets.QGridLayout where the widget is added</span>
<span class="sd">    :param widget_position: position of the widget in the parent layout, length</span>
<span class="sd">        2 ``(row, col)`` or 4 ``(row, col, rowspan, colspan)``</span>
<span class="sd">    :type widget_position: tuple</span>
<span class="sd">    :param im: RGB image array of shape :math:`(width, height, 3)`</span>
<span class="sd">    :type im: numpy array</span>
<span class="sd">    :param box_size: size of the image, either an integer if same value for</span>
<span class="sd">        width and height, or a tuple of length 2 ``(width, height)``</span>
<span class="sd">    :type box_size: int or tuple</span>

<span class="sd">    :returns: widget containing the image</span>
<span class="sd">    :rtype: ToolsPyqtgraph.PlotWidget</span>

<span class="sd">    :author: Raphael Weber</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">widget</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">createWidgetImage</span><span class="p">(</span><span class="n">lay</span><span class="p">,</span> <span class="n">widget_position</span><span class="p">,</span> <span class="n">im</span><span class="o">=</span><span class="n">im</span><span class="p">)</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">setMouseEnabled</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">hideButtons</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">box_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">box_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">box_size</span><span class="p">,</span> <span class="n">box_size</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">box_size</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">box_size</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="ow">and</span> \
                <span class="nb">len</span><span class="p">(</span><span class="n">box_size</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="n">box_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">box_size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">widget</span></div>


<div class="viewcode-block" id="createWidgetSignal"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.createWidgetSignal">[docs]</a><span class="k">def</span> <span class="nf">createWidgetSignal</span><span class="p">(</span>
    <span class="n">lay</span><span class="p">,</span> <span class="n">widget_position</span><span class="p">,</span> <span class="n">y_range</span><span class="o">=</span><span class="p">[],</span> <span class="n">left_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">left_label_style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#000&#39;</span><span class="p">,</span> <span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;10pt&#39;</span><span class="p">},</span>
    <span class="n">ticks_color</span><span class="o">=</span><span class="s2">&quot;#000&quot;</span><span class="p">,</span> <span class="n">ticks_size</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">ticks_offset</span><span class="o">=</span><span class="mi">0</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a widget for plotting signals (see</span>
<span class="sd">    :class:`.ToolsPyqtgraph.SignalWidget) and adds it to a grid layout (used in</span>
<span class="sd">    :class:`.ViSiAnnoT`)</span>

<span class="sd">    For details about color, see</span>
<span class="sd">    https://pyqtgraph.readthedocs.io/en/latest/functions.html#color-pen-and-brush-functions</span>

<span class="sd">    :param lay: parent layout where the widget is added</span>
<span class="sd">    :type lay: QtWidgets.QGridLayout</span>
<span class="sd">       instance of QtWidgets.QGridLayout where the widget is added</span>
<span class="sd">    :param widget_position: position of the widget in the parent layout, length</span>
<span class="sd">        2 ``(row, col)`` or 4 ``(row, col, rowspan, colspan)``</span>
<span class="sd">    :type widget_position: tuple</span>
<span class="sd">    :param y_range: visible Y range, length 2 ``(y_min, y_max)``, set to</span>
<span class="sd">        ``[]`` for auto range</span>
<span class="sd">    :type y_range: tuple</span>
<span class="sd">    :param left_label: label for Y axis</span>
<span class="sd">    :type left_label: str</span>
<span class="sd">    :param left_label_style: axis label title style</span>
<span class="sd">    :type left_label_style: dict</span>
<span class="sd">    :param ticks_color: color of the ticks text in HEX string or RGB format</span>
<span class="sd">    :type ticks_color: str or tuple</span>
<span class="sd">    :param ticks_size: font size of the ticks text in pt</span>
<span class="sd">    :type ticks_size: float or int</span>
<span class="sd">    :param ticks_offset: ticks text offset</span>
<span class="sd">    :type ticks_offset: int</span>

<span class="sd">    :returns: widget containing the signals plots</span>
<span class="sd">    :rtype: ToolsPyQt.SignalWidget</span>

<span class="sd">    :author: Raphael Weber</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># create the widget</span>
    <span class="n">widget</span> <span class="o">=</span> <span class="n">SignalWidget</span><span class="p">()</span>

    <span class="c1"># add the widget to the layout</span>
    <span class="n">addWidgetToLayout</span><span class="p">(</span><span class="n">lay</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">widget_position</span><span class="p">)</span>

    <span class="c1"># disable default mouse interaction</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">setMouseEnabled</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># disable plot menu</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">setMenuEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># set axes font</span>
    <span class="n">setTicksTextStyle</span><span class="p">(</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">getAxis</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">ticks_color</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">ticks_size</span><span class="p">,</span>
        <span class="n">offset</span><span class="o">=</span><span class="n">ticks_offset</span>
    <span class="p">)</span>

    <span class="n">setTicksTextStyle</span><span class="p">(</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">getAxis</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">ticks_color</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">ticks_size</span><span class="p">,</span>
        <span class="n">offset</span><span class="o">=</span><span class="n">ticks_offset</span>
    <span class="p">)</span>

    <span class="c1"># set Y axis label</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">getAxis</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">left_label</span><span class="p">,</span> <span class="o">**</span><span class="n">left_label_style</span><span class="p">)</span>

    <span class="c1"># disable auto-range on X axis</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">enableAutoRange</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">enable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># check if Y range is to be set</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_range</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">y_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">y_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="c1"># set Y range</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setYRange</span><span class="p">(</span><span class="n">y_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># disable default mouse interaction</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setMouseEnabled</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># hide auto range button</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">hideButtons</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># enable auto-range on Y axis</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">enableAutoRange</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">widget</span></div>


<div class="viewcode-block" id="setTicksTextStyle"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.setTicksTextStyle">[docs]</a><span class="k">def</span> <span class="nf">setTicksTextStyle</span><span class="p">(</span><span class="n">axis_item</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#000&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets ticks text style of an axis item</span>

<span class="sd">    See https://pyqtgraph.readthedocs.io/en/latest/graphicsItems/axisitem.html</span>
<span class="sd">    for details.</span>

<span class="sd">    :param axis_item: axis for which the style of ticks text must be set</span>
<span class="sd">    :type axis_item: pyqtgraph.AxisItem</span>
<span class="sd">    :param color: color of the text in HEX string or RGB format</span>
<span class="sd">    :type color: str or tuple</span>
<span class="sd">    :param size: font size of the text in pt</span>
<span class="sd">    :type size: float or int</span>
<span class="sd">    :param offset: text offset</span>
<span class="sd">    :type offset: int</span>

<span class="sd">    :author: Raphael Weber</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># set ticks color</span>
    <span class="n">axis_item</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">axis_item</span><span class="o">.</span><span class="n">setTextPen</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

    <span class="c1"># create font with desired size</span>
    <span class="n">font</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">()</span>
    <span class="n">font</span><span class="o">.</span><span class="n">setPointSize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

    <span class="c1"># set ticks size</span>
    <span class="n">axis_item</span><span class="o">.</span><span class="n">setTickFont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>

    <span class="c1"># set offset</span>
    <span class="n">axis_item</span><span class="o">.</span><span class="n">setStyle</span><span class="p">(</span><span class="n">tickTextOffset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span></div>


<div class="viewcode-block" id="deleteNaNForPlot"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.deleteNaNForPlot">[docs]</a><span class="k">def</span> <span class="nf">deleteNaNForPlot</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deletes NaNs from an array so that they are ignored for plotting</span>

<span class="sd">    :param data: array where to delete NaNs, shape :math:`(n,)` or</span>
<span class="sd">        :math:`(n, 2)` (where first column contains timestamp, second column</span>
<span class="sd">        contains data value), list and tuple are also supported</span>
<span class="sd">    :type data: numpy array</span>

<span class="sd">    :returns: array without NaNs, shape :math:`(m, 2)`, with :math:`m \leq n` ;</span>
<span class="sd">        if the input array is 1D (shape :math:`(n,)`), then the first column of</span>
<span class="sd">        the output array contains the index of each point in the input array</span>
<span class="sd">    :rtype: numpy array</span>

<span class="sd">    :author: Raphael Weber</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">data</span>
        <span class="p">))</span><span class="o">.</span><span class="n">T</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="addPlotTo2DWidget"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.addPlotTo2DWidget">[docs]</a><span class="k">def</span> <span class="nf">addPlotTo2DWidget</span><span class="p">(</span>
    <span class="n">widget</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">flag_clear</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_nan_void</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plot_style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pen&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a plot item to a 2D widget</span>

<span class="sd">    For details about plot style, see</span>
<span class="sd">    https://pyqtgraph.readthedocs.io/en/latest/graphicsItems/plotdataitem.html</span>

<span class="sd">    For details about color, see</span>
<span class="sd">    https://pyqtgraph.readthedocs.io/en/latest/functions.html#color-pen-and-brush-functions</span>

<span class="sd">    :param widget: widget where the plot must be displayed</span>
<span class="sd">    :type widget: pyqtgraph.PlotWidget</span>
<span class="sd">    :param data: data to plot, two possibilites:</span>

<span class="sd">        - shape :math:`(n, 2)`, first column contains X values, second column</span>
<span class="sd">          contains Y values, if only one point to plot make sure to have</span>
<span class="sd">          shape :math:`(1, 2)`</span>
<span class="sd">        - shape :math:`(n,)`, only Y values, then X values are the array</span>
<span class="sd">          indexes</span>
<span class="sd">    :type data: numpy array</span>
<span class="sd">    :param flag_clear: specify if content currently displayed must be cleared</span>
<span class="sd">        before plotting the data</span>
<span class="sd">    :type flag_clear: bool</span>
<span class="sd">    :param flag_nan_void: specify how to handle NaN values</span>

<span class="sd">        - ``False``: default behaviour of pyqtgraph</span>
<span class="sd">        - ``True``: there is no plotting where NaN</span>

<span class="sd">        NB: when calling the method ``plot.setData(data_array)``, the behaviour</span>
<span class="sd">        is back to default. If NaNs must be ignored, the function</span>
<span class="sd">        :func:`.ToolsPyqtgraph.deleteNaNForPlot` must be called before.</span>
<span class="sd">    :type flag_nan_void: bool</span>
<span class="sd">    :param plot_style: plot style, keys are keyword arguments of the</span>
<span class="sd">        constructor of pyqtgraph.PlotDataItem, see link above</span>
<span class="sd">    :type plot_style: dict</span>

<span class="sd">    :returns: plot item (or a list of pyqtgraph.PlotDataItem in case</span>
<span class="sd">        ``nan_void`` is true)</span>
<span class="sd">    :rtype: pyqtgraph.PlotDataItem</span>

<span class="sd">    :author: Raphael Weber</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">flag_clear</span><span class="p">:</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">flag_nan_void</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">deleteNaNForPlot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">plot</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">PlotDataItem</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_style</span><span class="p">)</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">plot</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">plot</span></div>


<div class="viewcode-block" id="basic2DPlot"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.basic2DPlot">[docs]</a><span class="k">def</span> <span class="nf">basic2DPlot</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">opts_win_dict</span><span class="o">=</span><span class="p">{},</span> <span class="n">opts_wid_dict</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">plot_style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pen&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a window with a 2D plot</span>

<span class="sd">    For details about plot style, see</span>
<span class="sd">    https://pyqtgraph.readthedocs.io/en/latest/graphicsItems/plotdataitem.html</span>

<span class="sd">    For details about color, see</span>
<span class="sd">    https://pyqtgraph.readthedocs.io/en/latest/functions.html#color-pen-and-brush-functions</span>

<span class="sd">    :param data: data to plot, two possibilites:</span>

<span class="sd">        - shape :math:`(n, 2)`, first column contains X values, second column</span>
<span class="sd">          contains Y values, if only one point to plot make sure to have</span>
<span class="sd">          shape :math:`(1, 2)`</span>
<span class="sd">        - shape :math:`(n,)`, only Y values, then X values are the array</span>
<span class="sd">          indexes</span>
<span class="sd">    :type data: numpy array</span>
<span class="sd">    :param opts_win_dict: keyword arguments of the function</span>
<span class="sd">        :func:`.ToolsPyQt.createWindow`</span>
<span class="sd">    :type opts_win_dict: dict</span>
<span class="sd">    :param opts_wid_dict: keyword arguments of the function</span>
<span class="sd">        :func:`.ToolsPyqtgraph.create2DWidget`</span>
<span class="sd">    :type opts_wid_dict: dict</span>
<span class="sd">    :param plot_style: plot style, keys are keyword arguments of the</span>
<span class="sd">        constructor of pyqtgraph.PlotDataItem, see link above</span>
<span class="sd">    :type plot_style: dict</span>

<span class="sd">    :returns:</span>
<span class="sd">        - **win** (*QWidgets.QWidget*) -- window container</span>
<span class="sd">        - **lay** (*QWidgets.QGridLayout*) -- layout</span>
<span class="sd">        - **widget** (*pyqtgraph.PlotWidget*) -- 2D widget filling the whole</span>
<span class="sd">          layout</span>
<span class="sd">        - **plot** (*pyqtgraph.PlotDataItem*) -- plot item</span>

<span class="sd">    :author: Raphael Weber</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">win</span><span class="p">,</span> <span class="n">lay</span> <span class="o">=</span> <span class="n">createWindow</span><span class="p">(</span><span class="o">**</span><span class="n">opts_win_dict</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;bg_color&quot;</span> <span class="ow">in</span> <span class="n">opts_win_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">setBackgroundColor</span><span class="p">(</span><span class="n">opts_win_dict</span><span class="p">[</span><span class="s2">&quot;bg_color&quot;</span><span class="p">])</span>

    <span class="n">widget</span> <span class="o">=</span> <span class="n">create2DWidget</span><span class="p">(</span><span class="n">lay</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">**</span><span class="n">opts_wid_dict</span><span class="p">)</span>

    <span class="n">plot</span> <span class="o">=</span> <span class="n">addPlotTo2DWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="n">plot_style</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">win</span><span class="p">,</span> <span class="n">lay</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">plot</span></div>


<div class="viewcode-block" id="basicImagePlot"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.basicImagePlot">[docs]</a><span class="k">def</span> <span class="nf">basicImagePlot</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a window with an image</span>

<span class="sd">    :param im: RGB image array of shape :math:`(width, height, 3)`</span>
<span class="sd">    :type im: numpy array</span>
<span class="sd">    :param kwargs: keyword arguments of the function</span>
<span class="sd">        :func:`.ToolsPyQt.createWindow`, if background color of the window is</span>
<span class="sd">        specified, then it is also applied to the image widget</span>

<span class="sd">    :returns:</span>
<span class="sd">        - **win** (*QWidgets.QWidget*) -- window container</span>
<span class="sd">        - **lay** (*QWidgets.QGridLayout*) -- layout</span>
<span class="sd">        - **widget** (*pyqtgraph.PlotWidget*) -- 2D widget filling the whole</span>
<span class="sd">          layout</span>
<span class="sd">        - **img** (*pyqtgraph.ImageItem*) -- image item</span>

<span class="sd">    :author: Raphael Weber</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">win</span><span class="p">,</span> <span class="n">lay</span> <span class="o">=</span> <span class="n">createWindow</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;bg_color&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">setBackgroundColor</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bg_color&quot;</span><span class="p">])</span>

    <span class="n">widget</span><span class="p">,</span> <span class="n">img</span> <span class="o">=</span> <span class="n">createWidgetImage</span><span class="p">(</span><span class="n">lay</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">im</span><span class="o">=</span><span class="n">im</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">win</span><span class="p">,</span> <span class="n">lay</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">img</span></div>


<div class="viewcode-block" id="addLegendTo2DWidget"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.addLegendTo2DWidget">[docs]</a><span class="k">def</span> <span class="nf">addLegendTo2DWidget</span><span class="p">(</span>
    <span class="n">widget</span><span class="p">,</span> <span class="n">item_dict</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;inside&#39;</span><span class="p">,</span>
    <span class="n">legend_wid_size</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a legend to a 2D widget</span>

<span class="sd">    If specified, this function creates a widget dedicated to the legend,</span>
<span class="sd">    instead of having a legend item inside the 2D widget.</span>

<span class="sd">    :param widget: widget containing the plot items to legend</span>
<span class="sd">    :type widget: pyqtgraph.PlotWidget</span>
<span class="sd">    :param item_dict: plot items to legend, key is the legend label and value</span>
<span class="sd">        is the associated plot item</span>
<span class="sd">    :type item_dict: dict</span>
<span class="sd">    :param size: size of the legend item, length 2 ``(width, height)``</span>
<span class="sd">    :type size: tuple</span>
<span class="sd">    :param offset: offset position in pixels of the legend item in the widget</span>
<span class="sd">    :type offset: tuple</span>
<span class="sd">    :param position: legend mode</span>

<span class="sd">        - ``&quot;inside&quot;``:  legend item inside the widget</span>
<span class="sd">        - ``&quot;right&quot;``: legend item is in a new widget created at the right side</span>
<span class="sd">          of the widget</span>
<span class="sd">        - ``&quot;bottom&quot;``:  legend is in a new widget created at the bottom side</span>
<span class="sd">          of the 2D widget</span>
<span class="sd">    :type position: str</span>
<span class="sd">    :param legend_wid_size: size of the created legend widget, length 2</span>
<span class="sd">        ``(width, height)`` in case ``position`` is ``&quot;right&quot;`` or</span>
<span class="sd">        ``&quot;bottom&quot;``</span>
<span class="sd">    :type legend_wid_size: tuple</span>

<span class="sd">    :returns:</span>
<span class="sd">        - **legend** (*-pyqtgraph.LegendItem*) -- legend item</span>
<span class="sd">        - **legend_widget** (*pyqtgraph.PlotWidget*) -- widget containing the</span>
<span class="sd">          legend item if it has been created (otherwise ``None``)</span>

<span class="sd">    :author: Raphael Weber</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">position</span> <span class="o">==</span> <span class="s1">&#39;inside&#39;</span><span class="p">:</span>
        <span class="c1"># create legend</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">LegendItem</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">graphicsItem</span><span class="p">())</span>
        <span class="n">legend_widget</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">elif</span> <span class="n">position</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span> <span class="ow">or</span> <span class="n">position</span> <span class="o">==</span> <span class="s1">&#39;bottom&#39;</span><span class="p">:</span>
        <span class="c1"># get the list of the window children, first element is the layout</span>
        <span class="c1"># the others are the widgets</span>
        <span class="n">win_children_list</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">children</span><span class="p">()</span>

        <span class="c1"># get the layout</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">win_children_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># get the widget index in the layout</span>
        <span class="n">wid_ind</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>

        <span class="c1"># get the widget position in the layout</span>
        <span class="n">wid_pos</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">getItemPosition</span><span class="p">(</span><span class="n">wid_ind</span><span class="p">)</span>

        <span class="c1"># get the legend widget position in the layout</span>
        <span class="k">if</span> <span class="n">position</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
            <span class="n">legend_wid_pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">wid_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">wid_pos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
                              <span class="n">wid_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">wid_pos</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                              <span class="n">wid_pos</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">position</span> <span class="o">==</span> <span class="s1">&#39;bottom&#39;</span><span class="p">:</span>
            <span class="n">legend_wid_pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">wid_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">wid_pos</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                              <span class="n">wid_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">wid_pos</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
                              <span class="mi">1</span><span class="p">,</span> <span class="n">wid_pos</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

        <span class="c1"># check if the legend widget has already been created</span>
        <span class="k">if</span> <span class="n">layout</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="n">legend_wid_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">legend_wid_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># create the legend widget</span>
            <span class="n">legend_widget</span> <span class="o">=</span> <span class="n">create2DWidget</span><span class="p">(</span>
                <span class="n">layout</span><span class="p">,</span> <span class="n">legend_wid_pos</span><span class="p">,</span> <span class="n">axes_label_dict</span><span class="o">=</span><span class="p">{}</span>
            <span class="p">)</span>

            <span class="c1"># set the size of the legend widget</span>
            <span class="k">if</span> <span class="n">legend_wid_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">legend_wid_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">legend_widget</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="n">legend_wid_size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">legend_wid_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">legend_wid_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">legend_widget</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">legend_wid_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">legend_wid_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">legend_widget</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span>
                    <span class="n">legend_wid_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">legend_wid_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># get the widget that contains the legend</span>
            <span class="c1"># assuming that it is the element right after the widget</span>
            <span class="n">legend_widget</span> <span class="o">=</span> \
                <span class="n">win_children_list</span><span class="p">[</span><span class="n">win_children_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="c1"># create legend</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">LegendItem</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="n">legend_widget</span><span class="o">.</span><span class="n">graphicsItem</span><span class="p">())</span>


    <span class="c1"># set the legend item to the corresponding item and label</span>
    <span class="k">for</span> <span class="n">item_label</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">item_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">item_label</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">legend</span><span class="p">,</span> <span class="n">legend_widget</span></div>


<div class="viewcode-block" id="addTextItemTo2DWidget"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.addTextItemTo2DWidget">[docs]</a><span class="k">def</span> <span class="nf">addTextItemTo2DWidget</span><span class="p">(</span>
    <span class="n">widget</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#000000&quot;</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="n">border</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">flag_arrow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arrow_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">arrow_style</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;headLen&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;tipAngle&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;pen&#39;</span><span class="p">:</span> <span class="s1">&#39;#000000&#39;</span><span class="p">,</span> <span class="s1">&#39;brush&#39;</span><span class="p">:</span> <span class="s1">&#39;#000000&#39;</span>
    <span class="p">}</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a text item to a 2D widget</span>

<span class="sd">    For details about color, see</span>
<span class="sd">    https://pyqtgraph.readthedocs.io/en/latest/functions.html#color-pen-and-brush-functions</span>

<span class="sd">    :param widget: widget where the text item must be displayed</span>
<span class="sd">    :type widget: pyqtgraph.PlotWidget</span>
<span class="sd">    :param pos: position of the text item in the widget, length 2 ``(x, y)``</span>
<span class="sd">    :type pos: tuple</span>
<span class="sd">    :param text: text to display</span>
<span class="sd">    :type text: str</span>
<span class="sd">    :param color: text color, may be a tuple with RGB or a HEX string</span>
<span class="sd">    :type color: str or tuple</span>
<span class="sd">    :param html: html text to display, it overwrites ``text`` and ``color``</span>
<span class="sd">    :type html: str</span>
<span class="sd">    :param anchor: coordinate of the text item that is anchored to its position</span>
<span class="sd">        ``pos`` (``(0, 0)`` =&gt; top left, ``(1, 0)`` =&gt; top right, ``(1, 0)`` =&gt;</span>
<span class="sd">        bottom left, ``(1, 1)`` =&gt; bottom right</span>
<span class="sd">    :type anchor: tuple</span>
<span class="sd">    :param border: color of the border, may be a tuple with RGB or a HEX</span>
<span class="sd">        string</span>
<span class="sd">    :type border: str or tuple</span>
<span class="sd">    :param fill: color used when filling within the border, may be a tuple with</span>
<span class="sd">        RGB or a HEX</span>
<span class="sd">    :type fill: str or tuple</span>
<span class="sd">    :param angle: angle in degrees to rotate the text item</span>
<span class="sd">    :type angle: float</span>
<span class="sd">    :param flag_arrow: specify if an arrow must be added</span>
<span class="sd">    :type flag_arrow: bool</span>
<span class="sd">    :param arrow_angle: angle in degrees to rotate the arrow</span>
<span class="sd">        (arrow pointing to the left)</span>
<span class="sd">    :type arrow_angle: float</span>
<span class="sd">    :param arrow_style: see</span>
<span class="sd">        https://pyqtgraph.readthedocs.io/en/latest/graphicsItems/arrowitem.html#pyqtgraph.ArrowItem.setStyle</span>
<span class="sd">    :type arrow_style: dict</span>

<span class="sd">    :returns:</span>
<span class="sd">        - **text_item** (*pyqtgraph.TextItem*)</span>
<span class="sd">        - **arrow_item** (*pyqtgraph.ArrowItem*) -- may be ``None`` if arrow</span>
<span class="sd">          not specified</span>

<span class="sd">    :author: Raphael Weber</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># create text item</span>
    <span class="n">text_item</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">TextItem</span><span class="p">(</span>
        <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="n">html</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">anchor</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="n">border</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span>
    <span class="p">)</span>

    <span class="c1"># set the text item position</span>
    <span class="n">text_item</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># add the text item to the widget</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">text_item</span><span class="p">)</span>

    <span class="c1"># create an arrow item if specified and add it to the widget</span>
    <span class="k">if</span> <span class="n">flag_arrow</span><span class="p">:</span>
        <span class="n">arrow_item</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">ArrowItem</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">arrow_angle</span><span class="p">)</span>
        <span class="n">arrow_item</span><span class="o">.</span><span class="n">setStyle</span><span class="p">(</span><span class="o">**</span><span class="n">arrow_style</span><span class="p">)</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">arrow_item</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">arrow_item</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">text_item</span><span class="p">,</span> <span class="n">arrow_item</span></div>


<div class="viewcode-block" id="createColorMap"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.createColorMap">[docs]</a><span class="k">def</span> <span class="nf">createColorMap</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">lut_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a color map</span>

<span class="sd">    See https://pyqtgraph.readthedocs.io/en/latest/colormap.html for details.</span>

<span class="sd">    :param values: values spanning the color map, at least two values are</span>
<span class="sd">        required, it may be a 1D numpy array</span>
<span class="sd">    :type values: list or tuple</span>
<span class="sd">    :param colors: colors corresponding to the values, must be the same length</span>
<span class="sd">        as ``values``, each element is a (RGB) color</span>
<span class="sd">    :type colors: list or numpy array</span>
<span class="sd">    :param lut_dim: dimension of the look up table</span>
<span class="sd">    :type lut_dim: int</span>

<span class="sd">    :returns:</span>
<span class="sd">        - **color_map** (*pyqtgraph.ColorMap*)</span>
<span class="sd">        - **lut** (*numpy array*) -- color of the look up table, shape</span>
<span class="sd">          ``(lut_dim, 4)``</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">color_map</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">ColorMap</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
    <span class="n">lut</span> <span class="o">=</span> <span class="n">color_map</span><span class="o">.</span><span class="n">getLookupTable</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">lut_dim</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">color_map</span><span class="p">,</span> <span class="n">lut</span></div>


<div class="viewcode-block" id="createWidgetColorBar"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.createWidgetColorBar">[docs]</a><span class="k">def</span> <span class="nf">createWidgetColorBar</span><span class="p">(</span>
    <span class="n">lay</span><span class="p">,</span> <span class="n">widget_position</span><span class="p">,</span> <span class="n">color_map</span><span class="p">,</span> <span class="n">lut</span><span class="p">,</span> <span class="n">ticks_values</span><span class="p">,</span> <span class="n">widget_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
    <span class="n">ticks_val_formatting</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">img_width</span><span class="o">=</span><span class="mi">5</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a widget with a color bar (useful for the legend of a heat map)</span>

<span class="sd">    :param lay: parent layout where the widget is added</span>
<span class="sd">    :type lay: QtWidgets.QGridLayout</span>
<span class="sd">    :param widget_position: position of the widget in the parent layout, length</span>
<span class="sd">        2 ``(row, col)`` or 4 ``(row, col, rowspan, colspan)``</span>
<span class="sd">    :type widget_position: tuple</span>
<span class="sd">    :param color_map: color map to define the color bar</span>
<span class="sd">    :type color_map: pyqtgraph.ColorMap</span>
<span class="sd">    :param lut: look up table to define the color bar</span>
<span class="sd">    :type lut: numpy array</span>
<span class="sd">    :param ticks_values: values of the ticks to display</span>
<span class="sd">    :type ticks_values: list or tuple</span>
<span class="sd">    :param widget_width: width of the widget in pixels</span>
<span class="sd">    :type widget_width: int</span>
<span class="sd">    :param ticks_val_formatting: formatting pattern of the ticks text</span>
<span class="sd">    :type ticks_val_formatting: str</span>
<span class="sd">    :param img_width: width of the color bar in pixels</span>
<span class="sd">    :type img_width: int</span>

<span class="sd">    :returns:</span>
<span class="sd">        - **wid_bar** (:class:`.ToolsPyqtgraph.PlotWidget`) -- widget</span>
<span class="sd">          containing the color bar</span>
<span class="sd">        - **bar_img_item** (*pyqtgraph.ImageItem*) -- image item of the color</span>
<span class="sd">          bar</span>

<span class="sd">    :author: Raphael Weber</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># legend color bar image</span>
    <span class="n">lut_img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">lut</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">lut_img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">lut_img</span><span class="p">,</span> <span class="p">(</span><span class="n">img_width</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># create legend widget</span>
    <span class="n">wid_bar</span><span class="p">,</span> <span class="n">bar_img_item</span> <span class="o">=</span> <span class="n">createWidgetImage</span><span class="p">(</span><span class="n">lay</span><span class="p">,</span> <span class="n">widget_position</span><span class="p">,</span> <span class="n">im</span><span class="o">=</span><span class="n">lut_img</span><span class="p">)</span>
    <span class="n">wid_bar</span><span class="o">.</span><span class="n">invertY</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">wid_bar</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="n">widget_width</span><span class="p">)</span>
    <span class="n">wid_bar</span><span class="o">.</span><span class="n">showAxis</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

    <span class="c1"># loop on ticks values</span>
    <span class="n">bar_ticks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ticks_values</span><span class="p">:</span>
        <span class="c1"># color corresponding to value</span>
        <span class="n">val_color</span> <span class="o">=</span> <span class="n">color_map</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">val</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>

        <span class="c1"># get similarity between the LUT and the value color</span>
        <span class="n">lut_val_similarity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lut</span> <span class="o">==</span> <span class="n">val_color</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># get color index in LUT</span>
        <span class="n">color_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">lut_val_similarity</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">color_ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">color_ind</span> <span class="o">=</span> <span class="n">color_ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if value color not in LUT, look for the closest</span>
            <span class="n">color_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">lut_val_similarity</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">diff_sum_prev</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
            <span class="k">for</span> <span class="n">ite</span><span class="p">,</span> <span class="n">color_ind_tmp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">color_inds</span><span class="p">):</span>
                <span class="n">diff_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lut</span><span class="p">[</span><span class="n">color_ind_tmp</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">-</span> <span class="n">val_color</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">diff_sum</span> <span class="o">&gt;=</span> <span class="n">diff_sum_prev</span> <span class="ow">and</span> <span class="n">ite</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">color_ind</span> <span class="o">=</span> <span class="n">color_inds</span><span class="p">[</span><span class="n">ite</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="k">break</span>
                <span class="n">diff_sum_prev</span> <span class="o">=</span> <span class="n">diff_sum</span>

        <span class="c1"># update ticks list</span>
        <span class="n">bar_ticks</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">color_ind</span><span class="p">,</span> <span class="n">ticks_val_formatting</span> <span class="o">%</span> <span class="n">val</span><span class="p">))</span>

    <span class="c1"># set Y ticks</span>
    <span class="n">right_axis</span> <span class="o">=</span> <span class="n">wid_bar</span><span class="o">.</span><span class="n">getAxis</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="n">right_axis</span><span class="o">.</span><span class="n">setTicks</span><span class="p">([</span><span class="n">bar_ticks</span><span class="p">])</span>
    <span class="n">right_axis</span><span class="o">.</span><span class="n">setStyle</span><span class="p">(</span><span class="n">stopAxisAtTick</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">wid_bar</span><span class="p">,</span> <span class="n">bar_img_item</span></div>


<div class="viewcode-block" id="addMeanStdPlotTo2DWidget"><a class="viewcode-back" href="../../../APIreference/tools/ToolsPyqtgraph/index.html#visiannot.tools.ToolsPyqtgraph.addMeanStdPlotTo2DWidget">[docs]</a><span class="k">def</span> <span class="nf">addMeanStdPlotTo2DWidget</span><span class="p">(</span>
    <span class="n">wid</span><span class="p">,</span> <span class="n">data_mean</span><span class="p">,</span> <span class="n">data_std</span><span class="p">,</span> <span class="n">data_X</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pen_std_style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">},</span>
    <span class="n">n_population_list</span><span class="o">=</span><span class="p">[],</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a plot item to a 2D widget, a vertical line is associated to each</span>
<span class="sd">    point of the plot item, particularly useful to display a mean/median curve</span>
<span class="sd">    with the standard deviation</span>

<span class="sd">    The method raises an exception if ``data_mean`` and ``data_std`` or</span>
<span class="sd">    ``data_mean`` and ``data_X`` do not have the same length.</span>

<span class="sd">    :param wid: widget where to add the plot items</span>
<span class="sd">    :type wid: pyqtgraph.PlotWidget</span>
<span class="sd">    :param data_mean: mean/median values (1D array)</span>
<span class="sd">    :type data_mean: numpy array</span>
<span class="sd">    :param data_std: standard deviation values (1D array), same length as</span>
<span class="sd">        ``data_mean``</span>
<span class="sd">    :type data_std: numpy array</span>
<span class="sd">    :param data_X: coordinates of the mean/std values on the X axis (1D array),</span>
<span class="sd">        must have the same length as ``data_mean``</span>
<span class="sd">    :type data_X: numpy array</span>
<span class="sd">    :param pen_std_style: style of the standard deviation plot item</span>
<span class="sd">    :type pen_std_style: dict</span>
<span class="sd">    :param n_population_list: number of samples at each point (same length than</span>
<span class="sd">        ``data_mean``), a text item is then added near each point</span>
<span class="sd">    :type n_population_list: list</span>
<span class="sd">    :param kwargs: keyword arguments of the function</span>
<span class="sd">        :func:`.ToolsPyqtgraph.addPlotTo2DWidget`, used for the plot item of</span>
<span class="sd">        the mean/median values</span>

<span class="sd">    :returns:</span>
<span class="sd">        - **mean_plot** (*pyqtgraph.PlotDataItem*) -- plot item of the</span>
<span class="sd">          mean/median values</span>
<span class="sd">        - **std_plot** (*pyqtgraph.PlotDataItem*) -- plot item of the standard</span>
<span class="sd">          deviation values</span>
<span class="sd">        - **text_item_list** (*list*) -- text items (pyqtgraph.TextItem) of the</span>
<span class="sd">          number of samples at each point, empty list if ``n_population_list``</span>
<span class="sd">          is empty</span>

<span class="sd">    :author: Raphael Weber</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># check shape</span>
    <span class="k">if</span> <span class="n">data_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">data_std</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;Mean and std do not have the same shape: </span><span class="si">%d</span><span class="s2"> vs </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span>
            <span class="p">(</span><span class="n">data_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data_std</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="n">data_X</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">data_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Mean and X array do not have the same shape: </span><span class="si">%d</span><span class="s2"> vs </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span>
                <span class="p">(</span><span class="n">data_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="p">)</span>

    <span class="c1"># format mean array if X data is provided</span>
    <span class="k">if</span> <span class="n">data_X</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data_mean_tmp</span> <span class="o">=</span> <span class="n">data_mean</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_mean_tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">data_X</span><span class="p">,</span> <span class="n">data_mean</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># format list of samples number</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_population_list</span><span class="p">)</span> <span class="o">!=</span> <span class="n">data_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">n_population_list</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>

    <span class="c1"># plot mean data</span>
    <span class="n">mean_plot</span> <span class="o">=</span> <span class="n">addPlotTo2DWidget</span><span class="p">(</span><span class="n">wid</span><span class="p">,</span> <span class="n">data_mean_tmp</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># create X data if necessary</span>
    <span class="k">if</span> <span class="n">data_X</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">data_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># get X axis step</span>
    <span class="k">if</span> <span class="n">data_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">x_step</span> <span class="o">=</span> <span class="n">data_X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x_step</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># initialize std curve array</span>
    <span class="n">data_std_tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="c1"># loop on median values</span>
    <span class="n">text_item_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">med</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">nb_samples</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">data_X</span><span class="p">,</span> <span class="n">data_mean</span><span class="p">,</span> <span class="n">data_std</span><span class="p">,</span> <span class="n">n_population_list</span>
    <span class="p">):</span>
        <span class="c1"># check if not NaN</span>
        <span class="k">if</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">med</span><span class="p">):</span>
            <span class="c1"># create std curve sub-array</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">med</span> <span class="o">-</span> <span class="n">std</span><span class="p">],</span>
                             <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">med</span> <span class="o">+</span> <span class="n">std</span><span class="p">],</span>
                             <span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_step</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">med</span> <span class="o">-</span> <span class="n">std</span><span class="p">],</span>
                             <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">x_step</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">med</span> <span class="o">-</span> <span class="n">std</span><span class="p">],</span>
                             <span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_step</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">med</span> <span class="o">+</span> <span class="n">std</span><span class="p">],</span>
                             <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">x_step</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">med</span> <span class="o">+</span> <span class="n">std</span><span class="p">]])</span>

            <span class="c1"># concatenate std curve array</span>
            <span class="n">data_std_tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">data_std_tmp</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>

            <span class="c1"># add text item with number of data</span>
            <span class="k">if</span> <span class="n">nb_samples</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">text_item</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">addTextItemTo2DWidget</span><span class="p">(</span>
                    <span class="n">wid</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x_step</span> <span class="o">/</span> <span class="mi">8</span><span class="p">,</span> <span class="n">med</span> <span class="o">+</span> <span class="n">std</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                    <span class="n">text</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">nb_samples</span>
                <span class="p">)</span>
                <span class="n">text_item_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text_item</span><span class="p">)</span>

    <span class="c1"># plot std curve</span>
    <span class="n">std_plot</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">PlotCurveItem</span><span class="p">(</span>
        <span class="n">data_std_tmp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">data_std_tmp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">pen</span><span class="o">=</span><span class="n">pen_std_style</span><span class="p">,</span>
        <span class="n">connect</span><span class="o">=</span><span class="s2">&quot;pairs&quot;</span>
    <span class="p">)</span>

    <span class="n">wid</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">std_plot</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mean_plot</span><span class="p">,</span> <span class="n">std_plot</span><span class="p">,</span> <span class="n">text_item_list</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020-2021, Universit√© Rennes 1

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>