

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>visiannot.configuration.Configuration &mdash; ViSiAnnoT 0.2.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> ViSiAnnoT
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide-visiannot.html">User guide: ViSiAnnoT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide-configuration.html">User guide: configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide-toolspyqt.html">User guide: ToolsPyQt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide-toolspyqtgraph.html">User guide: ToolsPyqtgraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../exe.html">Creating a standalone executable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software.html">Software description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../further.html">Further developments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../APIreference/index.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ViSiAnnoT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>visiannot.configuration.Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for visiannot.configuration.Configuration</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#</span>
<span class="c1"># Copyright Universit√© Rennes 1</span>
<span class="c1"># Contributor: Raphael Weber</span>
<span class="c1">#</span>
<span class="c1"># Under CeCILL license</span>
<span class="c1"># http://www.cecill.info</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module defining :class:`.Configuration`</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="k">import</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">ast</span> <span class="k">import</span> <span class="n">literal_eval</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">..tools</span> <span class="k">import</span> <span class="n">ToolsPyQt</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>


<div class="viewcode-block" id="Configuration"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration">[docs]</a><span class="k">class</span> <span class="nc">Configuration</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">lay_parent</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">config_type</span><span class="p">,</span> <span class="n">nb_level</span><span class="p">,</span> <span class="n">elt_list</span><span class="p">,</span>
        <span class="n">default_config_list</span><span class="p">,</span> <span class="n">help_text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">config_base_name</span><span class="o">=</span><span class="s2">&quot;config_&quot;</span><span class="p">,</span>
        <span class="n">pos_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flag_dir_identical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_key</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">parent_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">children_config_name_list</span><span class="o">=</span><span class="p">[]</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class defining a configuration and its widget</span>

<span class="sd">        The widget is contained in :attr:`.Configuration.lay` and</span>
<span class="sd">        :attr:`.group_box`. The group box is added to the input window stored</span>
<span class="sd">        in the attribute :attr:`.lay_parent`.</span>

<span class="sd">        The configuration dictionary is stored in the attribute</span>
<span class="sd">        :attr:`.dict`.</span>

<span class="sd">        There are 3 callback methods for user interaction:</span>

<span class="sd">        - :meth:`.addConfigCallback` =&gt; adding a</span>
<span class="sd">          (sub-)configuration</span>
<span class="sd">        - :meth:`.deleteConfiguration` =&gt; deleting a</span>
<span class="sd">          (sub-)configuration</span>
<span class="sd">        - :meth:`.setDirectory` =&gt; setting the directory where to</span>
<span class="sd">          find data (if necessary)</span>

<span class="sd">        We can add a new configuration to the widget thanks to the push button</span>
<span class="sd">        &quot;Add&quot; (contained in :attr:`.button_group_add`).</span>
<span class="sd">        This will add an instance of QtWidgets.QGridLayout to</span>
<span class="sd">        :attr:`.Configuration.lay`, that we call a configuration grid.</span>
<span class="sd">        This configuration grid is contained in an instance of</span>
<span class="sd">        QtWidgets.QGroupBox. The configuration grids are stored in the list</span>
<span class="sd">        :attr:`.config_grid_list` and the configuration group</span>
<span class="sd">        boxes are stored in the list</span>
<span class="sd">        :attr:`.config_group_box_list`.</span>

<span class="sd">        On the one hand, for a given configuration grid, we can have a single</span>
<span class="sd">        configuration list to set, in this case :attr:`.nb_level`</span>
<span class="sd">        is set to 1. For example, this is the case for video configuration: for</span>
<span class="sd">        a given camera ID, there is only 1 video file to display.</span>

<span class="sd">        On the other hand, for a given configuration grid, we can have a list</span>
<span class="sd">        of configuration lists to set, in this case</span>
<span class="sd">        :attr:`.nb_level` is set to 2. For example, this the case</span>
<span class="sd">        for signal configuration: for a given signal type, there can be several</span>
<span class="sd">        data to plot on the same widget.</span>

<span class="sd">        The number of sub-configurations in each configuration grid is stored</span>
<span class="sd">        in the list :attr:`.nb_sub_list`.</span>

<span class="sd">        :param lay_parent: parent layout where the configuration group box is</span>
<span class="sd">            added</span>
<span class="sd">        :type lay_parent: QtWidgets.QGridLayout</span>
<span class="sd">        :param position: position of the configuration widget in the layout of</span>
<span class="sd">            the input window, length 2 ``(row, col)`` or 4</span>
<span class="sd">            ``(row, col, rowspan, colspan)``</span>
<span class="sd">        :type position: tuple of integers</span>
<span class="sd">        :param config_type: configuration type, see</span>
<span class="sd">            :attr:`.ConfigurationWindow.config_type_list`</span>
<span class="sd">        :type config_type: str</span>
<span class="sd">        :param nb_level: number of nesting levels for a configuration list,</span>
<span class="sd">            typically 1 (video) or 2 (signal)</span>
<span class="sd">        :type nb_level: int</span>
<span class="sd">        :param elt_list: list of the elements defining a configuration list</span>
<span class="sd">            in the group box, the length is equal to the length of a</span>
<span class="sd">            configuration list, each element is a tuple of length 3:</span>

<span class="sd">            - (*str*) Type of widget for the element, might be one of the</span>
<span class="sd">              following:</span>

<span class="sd">                - ``&quot;edit&quot;`` (QLineEdit, the value is a string),</span>
<span class="sd">                - ``&quot;edit_freq&quot;`` (QLineEdit, the value is converted to a float</span>
<span class="sd">                  if necessary, otherwise stick to a string),</span>
<span class="sd">                  ``&quot;edit_float&quot;`` (QLineEdit, the value is converted to a</span>
<span class="sd">                  float or an exception is raised if conversion failed),</span>
<span class="sd">                - ``&quot;edit_literal&quot;`` (QLineEdit, ``ast.literal_eval`` is</span>
<span class="sd">                  applied on the value, so that ``None`` or dictionary are</span>
<span class="sd">                  retrieved),</span>
<span class="sd">                - ``&quot;spin&quot;`` (QSpinBox, the value is an integer),</span>
<span class="sd">            - (*int*) Number of widgets for the element (for example, RGB color</span>
<span class="sd">              might be defined as 3 spin boxes, then the value is a tuple of 3</span>
<span class="sd">              elements),</span>
<span class="sd">            - (*dict*) Keyword parameters to pass to the element widget</span>
<span class="sd">              constructor (for example, for ``&quot;spin&quot;``, ``{&quot;minimum&quot;: 0,</span>
<span class="sd">              &quot;maximum&quot;: 255}``)</span>
<span class="sd">        :type elt_list: list</span>
<span class="sd">        :param default_config_list: default configuration list to display when</span>
<span class="sd">            adding a (sub-)configuration, make sure to give a nested list if</span>
<span class="sd">            ``nb_level`` equals 2</span>
<span class="sd">        :type default_config_list: list</span>
<span class="sd">        :param help_text: text to display in the help window, describing the</span>
<span class="sd">            different elements of a configuration list</span>
<span class="sd">        :type help_text: str</span>
<span class="sd">        :param config_base_name: base name of the configuration keys in</span>
<span class="sd">            :attr:`.dict`, the index of the configuration (in order of</span>
<span class="sd">            creation) is appended to ``config_base_name``</span>
<span class="sd">        :type config_base_name: str</span>
<span class="sd">        :param pos_dir: index of the widget element in ``elt_list`` which is a</span>
<span class="sd">            directory, it is then linked to a push button that opens a dialog</span>
<span class="sd">            window for selecting a directory</span>
<span class="sd">        :type pos_dir: int</span>
<span class="sd">        :param flag_dir_identical: in case ``pos_dir`` is not ``None``, specify</span>
<span class="sd">            if the directories of the different configurations must be the</span>
<span class="sd">            same, implying that when the directory of one configuration is</span>
<span class="sd">            modified, the directory of the other configurations is also modifed</span>
<span class="sd">            (currently only working when modifying directory with push button)</span>
<span class="sd">        :type flag_dir_identical: bool</span>
<span class="sd">        :param flag_key: specify if the configuration key can be modified</span>
<span class="sd">            thanks to a line edit (puts a QLineEdit widget element on the</span>
<span class="sd">            left side of each configuration)</span>
<span class="sd">        :type flag_key: bool</span>
<span class="sd">        :param parent_config: parent configuration, if a parent</span>
<span class="sd">            configuration is specified, then the configuration keys of</span>
<span class="sd">            :attr:`.dict` are forced to be the same as in the</span>
<span class="sd">            configuration parent dictionary</span>
<span class="sd">        :type parent_config: :class:`.Configuration`</span>
<span class="sd">        :param children_config_name_list: list of strings with the name of</span>
<span class="sd">            children configurations</span>
<span class="sd">        :type children_config_name_list: list</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#: (*QtWidgets.QGridLayout*) See first positional argument of</span>
        <span class="c1">#: :class:`.Configuration` constructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lay_parent</span> <span class="o">=</span> <span class="n">lay_parent</span>

        <span class="c1">#: (*str*) See third positional argument of :class:`.Configuration`</span>
        <span class="c1">#: constructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">config_type</span>

        <span class="c1">#: (*int*) Nesting level of configuration list, either ``1`` or ``2``</span>
        <span class="c1">#:</span>
        <span class="c1">#: - ``1``: single list (single line in configuration grid)</span>
        <span class="c1">#: - ``2``: list of lists (ability to add sub-configuration in</span>
        <span class="c1">#:   a configuration grid)</span>
        <span class="c1">#:</span>
        <span class="c1">#: The value of this attribute depends on the value of</span>
        <span class="c1">#: :attr:`.type`, as follows:</span>
        <span class="c1">#:</span>
        <span class="c1">#: - ``&quot;Video&quot;``: 1</span>
        <span class="c1">#: - ``&quot;Signal&quot;``: 2</span>
        <span class="c1">#: - ``&quot;Interval&quot;``: 2</span>
        <span class="c1">#: - ``&quot;Threshold&quot;``: 2</span>
        <span class="c1">#: - ``&quot;YRange&quot;``: 1</span>
        <span class="c1">#: - ``&quot;AnnotEvent&quot;``: 1</span>
        <span class="c1">#: - ``&quot;AnnotImage&quot;``: 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb_level</span> <span class="o">=</span> <span class="n">nb_level</span>

        <span class="c1">#: (*list*) See fifth positional argument of :class:`.Configuration`</span>
        <span class="c1">#: constructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elt_list</span> <span class="o">=</span> <span class="n">elt_list</span>

        <span class="c1">#: (*int*) See sixth positional argument of :class:`.Configuration`</span>
        <span class="c1">#: constructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_config_list</span> <span class="o">=</span> <span class="n">default_config_list</span>

        <span class="c1">#: (*int*) See keyword argument ``flag_dir_identical`` of</span>
        <span class="c1">#: :class:`.Configuration` constructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flag_dir_identical</span> <span class="o">=</span> <span class="n">flag_dir_identical</span>

        <span class="c1">#: (*int*) See keyword argument ``flag_key`` of :class:`.Configuration`</span>
        <span class="c1">#: constructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flag_key</span> <span class="o">=</span> <span class="n">flag_key</span>

        <span class="c1">#: (*int*) See keyword argument ``pos_dir`` of :class:`.Configuration`</span>
        <span class="c1">#: constructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos_dir</span> <span class="o">=</span> <span class="n">pos_dir</span>

        <span class="c1">#: (*int*) Index of the widget element in the configuration grid which</span>
        <span class="c1">#: is a directory, it is then linked to a push button that opens a</span>
        <span class="c1">#: dialog window for selecting a directory</span>
        <span class="c1">#:</span>
        <span class="c1">#: It is equal to :attr:`.pos_dir`, unless :attr:`.flag_key` is set to</span>
        <span class="c1">#: ``True``, which implies that a QLineEdit is added at the beginning</span>
        <span class="c1">#: of the configuration grid, so the index is incremented by 1.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos_dir_grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_dir</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_key</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos_dir_grid</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1">#: (*int*) See keyword argument ``config_base_name`` of</span>
        <span class="c1">#: :class:`.Configuration` constructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_base_name</span> <span class="o">=</span> <span class="n">config_base_name</span>

        <span class="c1">#: (:class:`.Configuration`) See keyword argument ``parent_config`` of</span>
        <span class="c1">#: :class:`.Configuration`</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent_config</span> <span class="o">=</span> <span class="n">parent_config</span>

        <span class="c1">#: (*list*) Instances of :class:`.Configuration` containing the</span>
        <span class="c1">#: children configurations</span>
        <span class="c1">#:</span>
        <span class="c1">#: When a configuration is deleted, the children configuration with the</span>
        <span class="c1">#: same key are deleted as well.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children_configuration_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1">#: (*dict*) Configuration dictionary, each item corresponds to one</span>
        <span class="c1">#: configuration grid of :attr:`.config_grid_list`, key is the</span>
        <span class="c1">#: configuration identifier (generated with :attr:`.config_base_name`),</span>
        <span class="c1">#: value is the configuration list (nested list in case of</span>
        <span class="c1">#: :attr:`.nb_level` equal to ``2``)</span>
        <span class="c1">#:</span>
        <span class="c1">#: The content of a configuration list depends on :attr:`.elt_list`,</span>
        <span class="c1">#: which specifies the type of its elements.</span>
        <span class="c1">#:</span>
        <span class="c1">#: Currently, 7 instances of :class:`.Configuration` are created in</span>
        <span class="c1">#: :class:`.ConfigurationWindow` (see :attr:`.config_type_list` for</span>
        <span class="c1">#: the corresponding configuration types). Here is the content of the</span>
        <span class="c1">#: configuration list according to the conifguration type:</span>
        <span class="c1">#:</span>
        <span class="c1">#: - ``&quot;Video&quot;`` (:attr:`.nb_level` is ``1``)</span>
        <span class="c1">#:</span>
        <span class="c1">#:      - (*str*) Directory where to find video files</span>
        <span class="c1">#:      - (*str*) File pattern</span>
        <span class="c1">#:      - (*str*) Delimiter for finding timestamp in file name</span>
        <span class="c1">#:      - (*str*) Position of the timestamp in file name after</span>
        <span class="c1">#:        splitting with delimiter</span>
        <span class="c1">#:      - (*str*) Format of timestamp string in file name</span>
        <span class="c1">#:</span>
        <span class="c1">#: - ``&quot;Signal&quot;`` (:attr:`.nb_level` is ``2`` =&gt; configuration list is</span>
        <span class="c1">#:   nested, configuration key is the name of the signal widget in</span>
        <span class="c1">#:   :class:`.ViSiAnnoT`)</span>
        <span class="c1">#:</span>
        <span class="c1">#:      - (*str*) Directory where to find data files</span>
        <span class="c1">#:      - (*str*) Key to access the data (in case of .h5 or .mat data</span>
        <span class="c1">#:        files)</span>
        <span class="c1">#:      - (*int* or *str*) Signal frequency, ``0`` if 2D data with</span>
        <span class="c1">#:        timestamps, it might be a string with the path to the key</span>
        <span class="c1">#:        containing the frequency in a .h5 or .mat file</span>
        <span class="c1">#:      - (*str*) File pattern</span>
        <span class="c1">#:      - (*str*) Delimiter for finding timestamp in file name</span>
        <span class="c1">#:      - (*str*) Position of the timestamp in file name after</span>
        <span class="c1">#:        splitting with delimiter</span>
        <span class="c1">#:      - (*str*) Format of timestamp string in file name</span>
        <span class="c1">#:      - (*dict*) Plot style (default is ``None``)</span>
        <span class="c1">#:</span>
        <span class="c1">#: - ``&quot;AnnotEvent&quot;`` (:attr:`.nb_level` is ``1``, configuration key is</span>
        <span class="c1">#:   the label)</span>
        <span class="c1">#:</span>
        <span class="c1">#:      - (*tuple*) RGB color</span>
        <span class="c1">#:</span>
        <span class="c1">#: - ``&quot;AnnotImage&quot;`` (:attr:`.nb_level` is ``1``)</span>
        <span class="c1">#:</span>
        <span class="c1">#:      - (*str*) Label</span>
        <span class="c1">#:</span>
        <span class="c1">#: - ``&quot;Interval&quot;`` (:attr:`.nb_level` is ``2`` =&gt; configuration list</span>
        <span class="c1">#:   is nested, child of ``Signal``)</span>
        <span class="c1">#:</span>
        <span class="c1">#:      - (*str*) Directory where to find data files</span>
        <span class="c1">#:      - (*str*) Key to access the data (in case of .h5 or .mat data</span>
        <span class="c1">#:        files)</span>
        <span class="c1">#:      - (*int* or *str*) Signal frequency, ``0`` if 2D data with</span>
        <span class="c1">#:        timestamps, it might be a string with the path to the key</span>
        <span class="c1">#:        containing the frequency in a .h5 or .mat file</span>
        <span class="c1">#:      - (*str*) File pattern</span>
        <span class="c1">#:      - (*str*) Delimiter for finding timestamp in file name</span>
        <span class="c1">#:      - (*str*) Position of the timestamp in file name after</span>
        <span class="c1">#:        splitting with delimiter</span>
        <span class="c1">#:      - (*str*) Format of timestamp string in file name</span>
        <span class="c1">#:      - (*tuple*) RGB color</span>
        <span class="c1">#:</span>
        <span class="c1">#: - ``&quot;Threshold&quot;`` (:attr:`.nb_level` is ``1``, child of ``Signal``)</span>
        <span class="c1">#:</span>
        <span class="c1">#:      - (*str*) Threshold value</span>
        <span class="c1">#:      - (*tuple*) RGB color</span>
        <span class="c1">#:</span>
        <span class="c1">#: - ``&quot;YRange&quot;`` (:attr:`.nb_level` is ``1``, child of ``Signal``)</span>
        <span class="c1">#:</span>
        <span class="c1">#:      - (*float*) Minimum value to display on Y axis in the</span>
        <span class="c1">#:        corresponding signal widget</span>
        <span class="c1">#:      - (*float*) Maximum value to display on Y axis in the</span>
        <span class="c1">#:        corresponding signal widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

        <span class="c1">#: (*list*) Instances of QtWidgets.QGridLayout containing the</span>
        <span class="c1">#: configuration grids (same order as :attr:`.config_group_box_list`),</span>
        <span class="c1">#: each grid corresponds to one key of :attr:`.dict`</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1">#: (*list*) Instances of QtWidgets.QGroupBox containing the</span>
        <span class="c1">#: configuration grids (same order as :attr:`.config_grid_list`),</span>
        <span class="c1">#: each group box corresponds to one key of :attr:`.dict`</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_group_box_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1">#: (*list*) Integers with the number of sub-configurations for each</span>
        <span class="c1">#: configuration grid (same order as :attr:`.config_grid_list`)</span>
        <span class="c1">#:</span>
        <span class="c1">#: If :attr:`.nb_level` is equal to 1, then each element</span>
        <span class="c1">#: equals 1.</span>
        <span class="c1">#:</span>
        <span class="c1">#: An example of configuration:</span>
        <span class="c1">#:</span>
        <span class="c1">#: - config_key_1</span>
        <span class="c1">#:</span>
        <span class="c1">#:      - sub_config_11</span>
        <span class="c1">#:      - sub_config_12</span>
        <span class="c1">#:</span>
        <span class="c1">#: - config_key_2</span>
        <span class="c1">#:</span>
        <span class="c1">#:      - sub_config_21</span>
        <span class="c1">#:</span>
        <span class="c1">#: - config_key_3</span>
        <span class="c1">#:</span>
        <span class="c1">#:      - sub_config_31</span>
        <span class="c1">#:      - sub_config_32</span>
        <span class="c1">#:      - sub_config_33</span>
        <span class="c1">#:</span>
        <span class="c1">#: It will give ``self.nb_sub_list == [2, 1, 3]``.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb_sub_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1">#: (*list*) Each element is a list with the configuration grid index</span>
        <span class="c1">#: and the sub-configuration index corresponding to the push buttons</span>
        <span class="c1">#: &quot;Change directory&quot;/&quot;Delete&quot;</span>
        <span class="c1">#:</span>
        <span class="c1">#: In case of :attr:`.nb_level` equal to 2, the</span>
        <span class="c1">#: sub-configurations are not necessarily added in the order of</span>
        <span class="c1">#: display, so the push buttons &quot;Change directory&quot; / &quot;Delete&quot; are not</span>
        <span class="c1">#: necessarily added in the order of display. As a consequence, the</span>
        <span class="c1">#: button groups :attr:`.button_group_del` and</span>
        <span class="c1">#: :attr:`.button_group_dir` contain the push buttons in</span>
        <span class="c1">#: the order of addition, which is decorrelated to the the order of</span>
        <span class="c1">#: display.</span>
        <span class="c1">#:</span>
        <span class="c1">#: When listening to the callbacks methods</span>
        <span class="c1">#: :meth:`.deleteConfiguration` and</span>
        <span class="c1">#: :meth:`.setDirectory`, the input argument is the push</span>
        <span class="c1">#: button index in the button group. We cannot link it explicitely to</span>
        <span class="c1">#: the configuration grid position. So, when a push button is added to</span>
        <span class="c1">#: the button group, the new sub-configuration grid position is</span>
        <span class="c1">#: appended to the list :attr:`.btn_id_to_config_id`.</span>
        <span class="c1">#:</span>
        <span class="c1">#: The position is expressed as a list with 2 integers:</span>
        <span class="c1">#:</span>
        <span class="c1">#: - index of the configuration grid (index in the list</span>
        <span class="c1">#:   :attr:`.config_grid_list`)</span>
        <span class="c1">#: - index of the sub-configuration grid inside the configuration grid</span>
        <span class="c1">#:</span>
        <span class="c1">#: An example of configuration with the zero-indexed order of addition</span>
        <span class="c1">#: (which gives the button index in the button group):</span>
        <span class="c1">#:</span>
        <span class="c1">#: - config_key_1</span>
        <span class="c1">#:</span>
        <span class="c1">#:      - sub_config_11 =&gt; 0</span>
        <span class="c1">#:      - sub_config_12 =&gt; 5</span>
        <span class="c1">#:</span>
        <span class="c1">#: - config_key_2</span>
        <span class="c1">#:</span>
        <span class="c1">#:      - sub_config_21 =&gt; 1</span>
        <span class="c1">#:</span>
        <span class="c1">#: - config_key_3</span>
        <span class="c1">#:</span>
        <span class="c1">#:      - sub_config_31 =&gt; 2</span>
        <span class="c1">#:      - sub_config_32 =&gt; 3</span>
        <span class="c1">#:      - sub_config_33 =&gt; 4</span>
        <span class="c1">#:</span>
        <span class="c1">#: It will give ``btn_id_to_config_id ==</span>
        <span class="c1">#: [[0, 0], [1, 0], [2, 0], [2, 1], [2, 2], [0, 1]]``.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_id_to_config_id</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1">#: (*int*) Number of rows in the group box header</span>
        <span class="c1">#:</span>
        <span class="c1">#: In all cases it equals ``1``.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb_rows_header</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1">#: (*int*) Number of columns spanned by the configuration grids in the</span>
        <span class="c1">#: layout of :attr:`.group_box`, equivalent to the number of widgets in</span>
        <span class="c1">#: the group box header minus 1</span>
        <span class="c1">#:</span>
        <span class="c1">#: Computed as ``2 + len(children_config_name_list)``: in the group box</span>
        <span class="c1">#: header, there are two widgets (&quot;Help&quot; push button / check box for</span>
        <span class="c1">#: identical directories or empty QLabel) and as many push buttons as</span>
        <span class="c1">#: children configurations. The configuration grids must span all those</span>
        <span class="c1">#: widgets.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_grid_span</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">children_config_name_list</span><span class="p">)</span>

        <span class="c1">#: (*QtWidgets.QGridLayout*) Layout filling the group box</span>
        <span class="c1">#: :attr:`.group_box`</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lay</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1">#: (*QtWidgets.QGroupBox*) Group box where configuration grids are</span>
        <span class="c1">#: created</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_box</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1">#: (*QtWidgets.QCheckBox*) Check box to specify if all directories</span>
        <span class="c1">#: are identical (when using the push button for changing directory),</span>
        <span class="c1">#: may be ``None``</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_box</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1">#: (*QtWidgets.QButtonGroup*) Group of buttons for displaying</span>
        <span class="c1">#: children configuration windows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_group_children</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QButtonGroup</span><span class="p">()</span>

        <span class="c1">#: (*QtWidgets.QButtonGroup*) Group of buttons for changing directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_group_dir</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QButtonGroup</span><span class="p">()</span>

        <span class="c1">#: (*QtWidgets.QButtonGroup*) Group of buttons for adding</span>
        <span class="c1">#: (sub-)configurations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_group_add</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QButtonGroup</span><span class="p">()</span>

        <span class="c1">#: (*QtWidgets.QButtonGroup*) Group of buttons for deleting</span>
        <span class="c1">#: (sub-)configurations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_group_del</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QButtonGroup</span><span class="p">()</span>

        <span class="c1">#: (*QtWidgets.QPushButton*) Push button for displaying help window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_help_show</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># create group box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createConfigurationGroupBox</span><span class="p">(</span>
            <span class="n">position</span><span class="p">,</span> <span class="n">children_config_name_list</span>
        <span class="p">)</span>

        <span class="c1">#: (*QtWidgets.QWidget*) Container of help window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">win_help</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1">#: (*QtWidgets.QPushButton*) Push button for hding help window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_help_hide</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># create help window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createHelpWindow</span><span class="p">(</span><span class="n">help_text</span><span class="p">)</span>

        <span class="c1"># listen to callbacks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_group_add</span><span class="o">.</span><span class="n">buttonClicked</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addConfigCallback</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">button_group_del</span><span class="o">.</span><span class="n">buttonClicked</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deleteConfiguration</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">button_group_dir</span><span class="o">.</span><span class="n">buttonClicked</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDirectory</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">button_help_show</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">win_help</span><span class="o">.</span><span class="n">show</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_help_hide</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">win_help</span><span class="o">.</span><span class="n">hide</span><span class="p">)</span>


<div class="viewcode-block" id="Configuration.addChildConfiguration"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration.addChildConfiguration">[docs]</a>    <span class="k">def</span> <span class="nf">addChildConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a child configuration to :attr:`.children_configuration_list`</span>

<span class="sd">        :param config_child: child configuration</span>
<span class="sd">        :type config_child: :class:`.Configuration`</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">children_configuration_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_child</span><span class="p">)</span></div>


<div class="viewcode-block" id="Configuration.createConfigurationGroupBox"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration.createConfigurationGroupBox">[docs]</a>    <span class="k">def</span> <span class="nf">createConfigurationGroupBox</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">children_config_name_list</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates group box and adds it to :attr:`.lay_parent`</span>

<span class="sd">        At this point, the group box contains only the header and one or</span>
<span class="sd">        several push buttons to add configurations.</span>

<span class="sd">        NB: make sure that :attr:`.type` is in</span>
<span class="sd">        :attr:`.ConfigurationWindow.config_type_list`.</span>

<span class="sd">        It sets the following attributes:</span>

<span class="sd">        - :attr:`.Configuration.lay`</span>
<span class="sd">        - :attr:`.group_box`</span>
<span class="sd">        - :attr:`.check_box`</span>
<span class="sd">        - :attr:`.button_help_show`</span>
<span class="sd">        - :attr:`.button_group_children`</span>
<span class="sd">        - :attr:`.button_group_add`</span>

<span class="sd">        :param position: position of the configuration group box in</span>
<span class="sd">            :attr:`.lay_parent`, length 2 ``(row, col)`` or</span>
<span class="sd">            4 ``(row, col, rowspan, colspan)``</span>
<span class="sd">        :type position: tuple</span>
<span class="sd">        :param children_config_name_list: names of the children configurations</span>
<span class="sd">        :type children_config_name_list: list</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># create configuration group box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lay</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_box</span> <span class="o">=</span> <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">addGroupBox</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lay_parent</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span>
        <span class="p">)</span>

        <span class="c1"># create push button for help text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_help_show</span> <span class="o">=</span> <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">addPushButton</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lay</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;Help&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span>
        <span class="p">)</span>

        <span class="c1"># check if check box needed for identical directories</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_dir_identical</span><span class="p">:</span>
            <span class="c1"># create check box for setting identical directories</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_box</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;All directories identical&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_box</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">check_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># add empty QLabel (for layout purpose)</span>
            <span class="n">label_empty</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label_empty</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># create push buttons for children configurations if necessary</span>
        <span class="k">for</span> <span class="n">ite_child</span><span class="p">,</span> <span class="n">children_config_name</span> <span class="ow">in</span> \
                <span class="nb">enumerate</span><span class="p">(</span><span class="n">children_config_name_list</span><span class="p">):</span>
            <span class="c1"># create push button for adding intervals</span>
            <span class="n">push_button</span> <span class="o">=</span> <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">addPushButton</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lay</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">ite_child</span><span class="p">),</span>
                <span class="n">children_config_name</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_group_children</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="n">push_button</span><span class="p">,</span> <span class="n">ite_child</span><span class="p">)</span>

        <span class="c1"># create push buttons for adding configuration</span>
        <span class="n">push_button_add</span> <span class="o">=</span> <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">addPushButton</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lay</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_grid_span</span><span class="p">),</span> <span class="s2">&quot;Add&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_group_add</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="n">push_button_add</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>


<div class="viewcode-block" id="Configuration.createHelpWindow"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration.createHelpWindow">[docs]</a>    <span class="k">def</span> <span class="nf">createHelpWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">help_text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates help window without showing it</span>

<span class="sd">        It has two widgets: a QLabel with the text and a push button for</span>
<span class="sd">        closing the window.</span>

<span class="sd">        :param help_text: text to be displayed</span>
<span class="sd">        :type help_text: str</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># create window and layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">win_help</span><span class="p">,</span> <span class="n">lay</span> <span class="o">=</span> <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">createWindow</span><span class="p">(</span>
            <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Help </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">flag_show</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="c1"># create scroll area</span>
        <span class="n">scroll_lay</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">addScrollArea</span><span class="p">(</span><span class="n">lay</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="c1"># add label with help text</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="n">help_text</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">scroll_lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

        <span class="c1"># add push button for closing help window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_help_hide</span> <span class="o">=</span> <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">addPushButton</span><span class="p">(</span>
            <span class="n">lay</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;Close&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">80</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Configuration.getConfigurationSimple"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration.getConfigurationSimple">[docs]</a>    <span class="k">def</span> <span class="nf">getConfigurationSimple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_grid</span><span class="p">,</span> <span class="n">row_ind</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads the values filled in a single row of a configuration grid in</span>
<span class="sd">        order to get the corresponding configuration list</span>

<span class="sd">        In case of :attr:`.nb_level` equal to ``2``, it does nor return a</span>
<span class="sd">        nested configuration list, but the sub-configuration list at index</span>
<span class="sd">        ``row_ind``.</span>

<span class="sd">        In case of :attr:`.nb_level` equal to ``2``, set ``row_ind`` to ``0``.</span>

<span class="sd">        :param config_grid: configuration grid</span>
<span class="sd">        :type config_grid: QtWidgets.QGridLayout</span>
<span class="sd">        :param row_ind: index of the row in the configuration grid from which</span>
<span class="sd">            to retrieve the (sub-)configuration list</span>
<span class="sd">        :type row_ind: int</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># check if configuration key is in the configuration grid</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_key</span><span class="p">:</span>
            <span class="c1"># skip first widget element of the configuration grid</span>
            <span class="c1"># (configuration key)</span>
            <span class="n">start_col_ind</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># get all widget elements of the configuration grid row</span>
            <span class="n">start_col_ind</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># initialize configuration list</span>
        <span class="n">config_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># loop on elements specifying configuration grid</span>
        <span class="k">for</span> <span class="n">ite_elt</span><span class="p">,</span> <span class="p">(</span><span class="n">elt_type</span><span class="p">,</span> <span class="n">elt_nb</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elt_list</span><span class="p">):</span>
            <span class="c1"># get widget</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="n">config_grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span>
                <span class="n">row_ind</span><span class="p">,</span> <span class="n">start_col_ind</span> <span class="o">+</span> <span class="n">ite_elt</span>
            <span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span>

            <span class="c1"># check number of sub-elements</span>
            <span class="k">if</span> <span class="n">elt_nb</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># check type</span>
                <span class="k">if</span> <span class="n">elt_type</span> <span class="o">==</span> <span class="s2">&quot;spin&quot;</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">setSpinBoxTable</span><span class="p">(</span>
                        <span class="n">widget</span><span class="o">.</span><span class="n">layout</span><span class="p">(),</span> <span class="p">[],</span> <span class="kc">False</span>
                    <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># check type</span>
                <span class="k">if</span> <span class="s2">&quot;edit&quot;</span> <span class="ow">in</span> <span class="n">elt_type</span><span class="p">:</span>
                    <span class="c1"># get value in widget</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

                    <span class="k">if</span> <span class="n">elt_type</span> <span class="o">==</span> <span class="s2">&quot;edit_float&quot;</span> <span class="ow">or</span> <span class="n">elt_type</span> <span class="o">==</span> <span class="s2">&quot;edit_freq&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">and</span> \
                                <span class="n">value</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="n">value_clean</span> <span class="o">=</span> \
                                <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

                            <span class="k">if</span> <span class="n">value_clean</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                                <span class="n">value_clean</span> <span class="o">=</span> <span class="n">value_clean</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">value_clean</span> <span class="o">=</span> <span class="n">value</span>

                        <span class="k">if</span> <span class="n">value_clean</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                            <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">))</span>

                        <span class="k">elif</span> <span class="n">elt_type</span> <span class="o">==</span> <span class="s2">&quot;edit_float&quot;</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span>
                                <span class="s2">&quot;Wrong value in </span><span class="si">%s</span><span class="s2"> configuration n¬∞</span><span class="si">%d</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">                                element </span><span class="si">%d</span><span class="s2">, expected a float, got </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">row_ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                    <span class="n">start_col_ind</span> <span class="o">+</span> <span class="n">ite_elt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value</span>
                                <span class="p">)</span>
                            <span class="p">)</span>

                    <span class="k">elif</span> <span class="n">elt_type</span> <span class="o">==</span> <span class="s2">&quot;edit_literal&quot;</span><span class="p">:</span>
                        <span class="c1"># convert &quot;None&quot; to None or &quot;{...}&quot; to a dictionary</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">elt_type</span> <span class="o">==</span> <span class="s2">&quot;spin&quot;</span> <span class="ow">or</span> <span class="n">elt_type</span> <span class="o">==</span> <span class="s2">&quot;spin_double&quot;</span><span class="p">:</span>
                    <span class="c1"># get value in widget</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

            <span class="c1"># append configuration list</span>
            <span class="n">config_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="c1"># check if only one element</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elt_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># return the single element instead of a list</span>
            <span class="n">config_list</span> <span class="o">=</span> <span class="n">config_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">config_list</span></div>


<div class="viewcode-block" id="Configuration.setDictionary"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration.setDictionary">[docs]</a>    <span class="k">def</span> <span class="nf">setDictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the attribute :attr:`.dict` with the current values</span>
<span class="sd">        filled in the configuration grids (:attr:`config_grid_list`)</span>

<span class="sd">        NB: make sure that :attr:`.type` is in</span>
<span class="sd">        :attr:`.ConfigurationWindow.config_type_list`.</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># reset configuration dictionary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

        <span class="c1"># loop on configurations</span>
        <span class="k">for</span> <span class="n">ite_config</span><span class="p">,</span> <span class="p">(</span><span class="n">config_grid</span><span class="p">,</span> <span class="n">config_group_box</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_group_box_list</span>
        <span class="p">)):</span>
            <span class="c1"># check if configuration key available in configuration grid</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_key</span><span class="p">:</span>
                <span class="c1"># get configuration key</span>
                <span class="n">config_key</span> <span class="o">=</span> <span class="n">config_grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

            <span class="c1"># check if child configuration</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># get configuration key</span>
                <span class="n">config_key</span> <span class="o">=</span> <span class="n">config_group_box</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># get configuration key</span>
                <span class="n">config_key</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_base_name</span><span class="p">,</span> <span class="n">ite_config</span><span class="p">)</span>

            <span class="c1"># check level</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_level</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">config_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfigurationSimple</span><span class="p">(</span><span class="n">config_grid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

                <span class="c1"># update configuration dictionary</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">config_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">config_list</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># get number of sub-configurations</span>
                <span class="n">nb_sub_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_sub_list</span><span class="p">[</span><span class="n">ite_config</span><span class="p">]</span>

                <span class="c1"># initialize configuration list</span>
                <span class="n">config_list</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="c1"># loop on sub-configurations</span>
                <span class="k">for</span> <span class="n">ite_sub</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_sub_config</span><span class="p">):</span>
                    <span class="n">config_sub_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfigurationSimple</span><span class="p">(</span>
                        <span class="n">config_grid</span><span class="p">,</span> <span class="n">ite_sub</span>
                    <span class="p">)</span>

                    <span class="c1"># append configuration list</span>
                    <span class="n">config_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_sub_list</span><span class="p">)</span>

                <span class="c1"># update configuration dictionary</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">config_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">config_list</span></div>


<div class="viewcode-block" id="Configuration.setDirectory"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration.setDirectory">[docs]</a>    <span class="k">def</span> <span class="nf">setDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback method for directory selection</span>

<span class="sd">        Connected to the signal ``buttonClicked[int]`` of</span>
<span class="sd">        :attr:`.button_group_dir`.</span>

<span class="sd">        :param button_id: index of the button that has been pushed</span>
<span class="sd">        :type button_id: int</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># get configuration grid index and sub-configuration index</span>
        <span class="n">config_id</span><span class="p">,</span> <span class="n">sub_config_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">btn_id_to_config_id</span><span class="p">[</span><span class="n">button_id</span><span class="p">]</span>

        <span class="c1"># get configuration grid</span>
        <span class="n">config_grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">[</span><span class="n">config_id</span><span class="p">]</span>

        <span class="c1"># get directory edit line</span>
        <span class="n">edit_dir</span> <span class="o">=</span> <span class="n">config_grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span>
            <span class="n">sub_config_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_dir_grid</span>
        <span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span>

        <span class="c1"># open dialog window to get directory</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Select directory&quot;</span><span class="p">,</span> <span class="n">edit_dir</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">ShowDirsOnly</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">directory</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="c1"># if box checked =&gt; all directories are identical</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="c1"># initialize a list of configurations</span>
                <span class="n">config_list_tmp</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>

                <span class="c1"># get children configurations, so that their directories are</span>
                <span class="c1"># updated as well</span>
                <span class="k">for</span> <span class="n">children_config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children_configuration_list</span><span class="p">:</span>
                    <span class="c1"># check if there are directories to set</span>
                    <span class="k">if</span> <span class="n">children_config</span><span class="o">.</span><span class="n">check_box</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">children_config</span><span class="o">.</span><span class="n">check_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                            <span class="n">config_list_tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">children_config</span><span class="p">)</span>

                <span class="c1"># loop on configurations</span>
                <span class="k">for</span> <span class="n">config_tmp</span> <span class="ow">in</span> <span class="n">config_list_tmp</span><span class="p">:</span>
                    <span class="c1"># loop on configuration grids</span>
                    <span class="k">for</span> <span class="n">ite_config</span><span class="p">,</span> <span class="n">config_grid_tmp</span> <span class="ow">in</span> \
                            <span class="nb">enumerate</span><span class="p">(</span><span class="n">config_tmp</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">):</span>
                        <span class="c1"># get number of sub-configurations</span>
                        <span class="n">nb_sub_config</span> <span class="o">=</span> <span class="n">config_tmp</span><span class="o">.</span><span class="n">nb_sub_list</span><span class="p">[</span><span class="n">ite_config</span><span class="p">]</span>

                        <span class="c1"># loop on sub-configurations</span>
                        <span class="k">for</span> <span class="n">ite_sub_config</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_sub_config</span><span class="p">):</span>
                            <span class="c1"># set line edit</span>
                            <span class="n">config_grid_tmp</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span>
                                <span class="n">ite_sub_config</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_dir_grid</span>
                            <span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># set line edit</span>
                <span class="n">edit_dir</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span></div>


<div class="viewcode-block" id="Configuration.addConfigCallback"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration.addConfigCallback">[docs]</a>    <span class="k">def</span> <span class="nf">addConfigCallback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback method for adding a (sub-)configuration</span>

<span class="sd">        Connected to the signal buttonClicked[int] of</span>
<span class="sd">        :attr:`.button_group_add`.</span>

<span class="sd">        There are two kinds of buttons:</span>

<span class="sd">        - ``button_id == 0``: add a configuration</span>
<span class="sd">        - ``button_id &gt;= 1``: add a sub-configuration (in case of</span>
<span class="sd">          :attr:`.nb_level` equal to 2)</span>

<span class="sd">        :param button_id: index of the button that has been pushed</span>
<span class="sd">        :type button_id: int</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># intialize boolean to specify if looking for identical directory</span>
        <span class="n">flag_dir_identical</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># check if there is a check box for identical directories</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_box</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># check if directories identical and if there is already</span>
            <span class="c1"># a configuration</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">flag_dir_identical</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># get configuration list</span>
        <span class="k">if</span> <span class="n">flag_dir_identical</span><span class="p">:</span>
            <span class="c1"># get directory of first configuration</span>
            <span class="n">dir_tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_dir_grid</span>
            <span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

            <span class="c1"># check number of levels</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_level</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># update default configuration list</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">default_config_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos_dir</span><span class="p">]</span> <span class="o">=</span> <span class="n">dir_tmp</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># update default configuration list</span>
                <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_config_list</span><span class="p">:</span>
                    <span class="n">sublist</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos_dir</span><span class="p">]</span> <span class="o">=</span> <span class="n">dir_tmp</span>

        <span class="c1"># add configuration</span>
        <span class="k">if</span> <span class="n">button_id</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># check if no parent configuration</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># get configuration key</span>
                <span class="n">config_key</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config_base_name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># get number of configurations</span>
                <span class="n">nb_config</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">)</span>

                <span class="c1"># get number of configurations in parent</span>
                <span class="n">nb_parent_config</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent_config</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">)</span>

                <span class="c1"># check if number of configurations is below the number of</span>
                <span class="c1"># configurations in parents</span>
                <span class="k">if</span> <span class="n">nb_config</span> <span class="o">&lt;</span> <span class="n">nb_parent_config</span><span class="p">:</span>
                    <span class="c1"># set new configuration key, same as parent</span>
                    <span class="n">config_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_config</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">[</span>
                        <span class="n">nb_config</span><span class="p">]</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

                    <span class="c1"># get following parent configuration key if the current one</span>
                    <span class="c1"># already exists in configuration dictionary</span>
                    <span class="k">while</span> <span class="n">config_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">nb_config</span> <span class="o">=</span> <span class="p">(</span><span class="n">nb_config</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> \
                            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent_config</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">)</span>

                        <span class="n">config_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_config</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">[</span>
                            <span class="n">nb_config</span><span class="p">]</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">config_key</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># create configuration dictionary</span>
            <span class="k">if</span> <span class="n">config_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">config_dict</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">config_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">config_key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_config_list</span><span class="p">}</span>

            <span class="c1"># add configuration</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addConfiguration</span><span class="p">(</span><span class="n">config_dict</span><span class="p">)</span>

        <span class="c1"># add sub-configuration</span>
        <span class="k">elif</span> <span class="n">button_id</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># loop on sub-configurations</span>
            <span class="k">for</span> <span class="n">config_sub_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_config_list</span><span class="p">:</span>
                <span class="c1"># add sub-configuration</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addConfigurationSimple</span><span class="p">(</span>
                    <span class="n">config_sub_list</span><span class="p">,</span> <span class="n">config_id</span><span class="o">=</span><span class="n">button_id</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span></div>


<div class="viewcode-block" id="Configuration.createWidgetsInConfigGrid"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration.createWidgetsInConfigGrid">[docs]</a>    <span class="k">def</span> <span class="nf">createWidgetsInConfigGrid</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">config_grid</span><span class="p">,</span> <span class="n">config_list</span><span class="p">,</span> <span class="n">row_ind</span><span class="p">,</span> <span class="n">start_col_ind</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates widgets elements for a new configuration list in a</span>
<span class="sd">        configuration grid</span>

<span class="sd">        :param config_grid: configuration grid where to add a configuration</span>
<span class="sd">            list</span>
<span class="sd">        :type config_grid: QtWidgets.QGridLayout</span>
<span class="sd">        :param config_list: configuration list with the values to fill in</span>
<span class="sd">        :type config_list: list</span>
<span class="sd">        :param row_ind: index of the row in the configuration grid where to add</span>
<span class="sd">            the widgets elementst of the configuration list</span>
<span class="sd">        :type row_ind: int</span>
<span class="sd">        :param start_col_ind: index of the column in the configuration grid</span>
<span class="sd">            where to start to add widgets elements of the configuration list</span>
<span class="sd">        :type start_col_ind: int</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># initialize column index of widget to add</span>
        <span class="n">col_ind</span> <span class="o">=</span> <span class="n">start_col_ind</span>

        <span class="c1"># check number of elements in a configuration list</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elt_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># put the single element in a list</span>
            <span class="n">config_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">config_list</span><span class="p">]</span>

        <span class="c1"># loop on elements to create for a configuration</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">elt_type</span><span class="p">,</span> <span class="n">elt_nb</span><span class="p">,</span> <span class="n">elt_params</span><span class="p">),</span> <span class="n">value</span> <span class="ow">in</span> \
                <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elt_list</span><span class="p">,</span> <span class="n">config_list</span><span class="p">):</span>
            <span class="c1"># check number of sub-elements</span>
            <span class="k">if</span> <span class="n">elt_nb</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># check element type</span>
                <span class="k">if</span> <span class="n">elt_type</span> <span class="o">==</span> <span class="s2">&quot;spin&quot;</span><span class="p">:</span>
                    <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">addSpinBoxTable</span><span class="p">(</span>
                        <span class="n">config_grid</span><span class="p">,</span> <span class="p">(</span><span class="n">row_ind</span><span class="p">,</span> <span class="n">col_ind</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">elt_nb</span><span class="p">,</span>
                        <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="n">elt_params</span><span class="p">]</span>
                    <span class="p">)</span>

                    <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">setSpinBoxTable</span><span class="p">(</span>
                        <span class="n">config_grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span>
                            <span class="n">row_ind</span><span class="p">,</span> <span class="n">col_ind</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">layout</span><span class="p">(),</span>
                        <span class="p">[</span><span class="n">value</span><span class="p">],</span> <span class="kc">True</span>
                    <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># check element type</span>
                <span class="k">if</span> <span class="s2">&quot;edit&quot;</span> <span class="ow">in</span> <span class="n">elt_type</span><span class="p">:</span>
                    <span class="c1"># create line edit</span>
                    <span class="n">widget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLineEdit</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="o">**</span><span class="n">elt_params</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">elt_type</span> <span class="o">==</span> <span class="s2">&quot;spin&quot;</span><span class="p">:</span>
                    <span class="c1"># create spin box</span>
                    <span class="n">widget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpinBox</span><span class="p">(</span><span class="o">**</span><span class="n">elt_params</span><span class="p">)</span>
                    <span class="n">widget</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">elt_type</span> <span class="o">==</span> <span class="s2">&quot;spin_double&quot;</span><span class="p">:</span>
                    <span class="c1"># create spin double box</span>
                    <span class="n">widget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="o">**</span><span class="n">elt_params</span><span class="p">)</span>
                    <span class="n">widget</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="c1"># add element to configuration grid</span>
                <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">addWidgetToLayout</span><span class="p">(</span>
                    <span class="n">config_grid</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="p">(</span><span class="n">row_ind</span><span class="p">,</span> <span class="n">col_ind</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="c1"># update column index</span>
            <span class="n">col_ind</span> <span class="o">+=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="Configuration.addConfigurationSimple"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration.addConfigurationSimple">[docs]</a>    <span class="k">def</span> <span class="nf">addConfigurationSimple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_list</span><span class="p">,</span> <span class="n">config_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a single (sub-)configuration list to a configuration grid</span>

<span class="sd">        This method updates the following attributes:</span>

<span class="sd">        - :attr:`.nb_sub_list`</span>
<span class="sd">        - :attr:`.btn_id_to_config_id`</span>
<span class="sd">        - :attr:`.dict`</span>
<span class="sd">        - :attr:`.button_group_dir` with the created push buttons</span>
<span class="sd">          for directory selection (if any)</span>
<span class="sd">        - :attr:`.button_group_del` with the created push button</span>
<span class="sd">          for deleting</span>

<span class="sd">        :param config_list: configuration list with the values to fill in</span>
<span class="sd">        :type config_list: list</span>
<span class="sd">        :param config_id: index of the configuration grid where to add the</span>
<span class="sd">            (sub-)configuration, by default the last configuration grid of</span>
<span class="sd">            :attr:`.config_grid_list` is chosen</span>
<span class="sd">        :type config_id: int</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># check if configuration key is in the configuration grid</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_key</span><span class="p">:</span>
            <span class="c1"># skip first widget element of the configuration grid</span>
            <span class="c1"># (configuration key)</span>
            <span class="n">start_col_ind</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># get all widget elements of the configuration grid row</span>
            <span class="n">start_col_ind</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># get configuration grid index if necessary</span>
        <span class="k">if</span> <span class="n">config_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">config_id</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="c1"># get configuration grid</span>
        <span class="n">config_grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">[</span><span class="n">config_id</span><span class="p">]</span>

        <span class="c1"># get sub-configuration index (should always be 0 if number of levels</span>
        <span class="c1"># is 1)</span>
        <span class="n">sub_ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_sub_list</span><span class="p">[</span><span class="n">config_id</span><span class="p">]</span>

        <span class="c1"># create widgets in the configuration grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createWidgetsInConfigGrid</span><span class="p">(</span>
            <span class="n">config_grid</span><span class="p">,</span> <span class="n">config_list</span><span class="p">,</span> <span class="n">sub_ind</span><span class="p">,</span> <span class="n">start_col_ind</span>
        <span class="p">)</span>

        <span class="c1"># set column index</span>
        <span class="n">col_ind</span> <span class="o">=</span> <span class="n">start_col_ind</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elt_list</span><span class="p">)</span>

        <span class="c1"># check if directory contained in configuration grid</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># create push button for selecting directory</span>
            <span class="n">push_button_dir</span> <span class="o">=</span> <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">addPushButton</span><span class="p">(</span>
                <span class="n">config_grid</span><span class="p">,</span> <span class="p">(</span><span class="n">sub_ind</span><span class="p">,</span> <span class="n">col_ind</span><span class="p">),</span> <span class="s2">&quot;Change directory&quot;</span><span class="p">)</span>

            <span class="c1"># add to button group</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_group_dir</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span>
                <span class="n">push_button_dir</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_sub_list</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="c1"># update column index</span>
            <span class="n">col_ind</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># create push button for deleting configuration</span>
        <span class="n">push_button_del</span> <span class="o">=</span> <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">addPushButton</span><span class="p">(</span>
            <span class="n">config_grid</span><span class="p">,</span> <span class="p">(</span><span class="n">sub_ind</span><span class="p">,</span> <span class="n">col_ind</span><span class="p">),</span> <span class="s2">&quot;Delete&quot;</span>
        <span class="p">)</span>

        <span class="c1"># add to button group button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_group_del</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span>
            <span class="n">push_button_del</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_sub_list</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># update list to convert button index to configuration index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_id_to_config_id</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">[</span><span class="n">config_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_sub_list</span><span class="p">[</span><span class="n">config_id</span><span class="p">]]</span>
        <span class="p">)</span>

        <span class="c1"># update number of sub-configurations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb_sub_list</span><span class="p">[</span><span class="n">config_id</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="Configuration.addConfiguration"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration.addConfiguration">[docs]</a>    <span class="k">def</span> <span class="nf">addConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds one or several configurations</span>

<span class="sd">        This method updates the following attributes:</span>

<span class="sd">        - :attr:`.config_grid_list`</span>
<span class="sd">        - :attr:`.config_group_box_list`</span>
<span class="sd">        - :attr:`.nb_sub_list`</span>
<span class="sd">        - :attr:`.btn_id_to_config_id`</span>
<span class="sd">        - :attr:`.dict`</span>
<span class="sd">        - :attr:`.button_group_dir` with the created push buttons</span>
<span class="sd">          for directory selection (if any)</span>
<span class="sd">        - :attr:`.button_group_del` with the created push button</span>
<span class="sd">          for deleting</span>

<span class="sd">        :param config_dict: dictionary of the configurations to add, see</span>
<span class="sd">            :attr:`.dict`</span>
<span class="sd">        :type config_dict: dict</span>

<span class="sd">        Each item of ``config_dict`` corresponds to one configuration, implying</span>
<span class="sd">        one created configuration grid. Value is a configuration list, which is</span>
<span class="sd">        nested if :attr:`.nb_level` is equal to ``2``, see :attr:`.dict`.</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># initialize row index in the grid where to add the configuration grid</span>
        <span class="n">row_start</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_rows_header</span>

        <span class="c1"># loop on configurations</span>
        <span class="k">for</span> <span class="n">config_key</span><span class="p">,</span> <span class="n">config_list</span> <span class="ow">in</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># create configuration grid</span>
            <span class="n">config_grid</span><span class="p">,</span> <span class="n">config_group_box</span> <span class="o">=</span> <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">addGroupBox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lay</span><span class="p">,</span> <span class="p">(</span><span class="n">row_start</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_grid_span</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># update lists</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_grid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_group_box_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_group_box</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nb_sub_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="c1"># check if child</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># set group box title as configuration key</span>
                <span class="n">config_group_box</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="n">config_key</span><span class="p">)</span>

            <span class="c1"># check if configuration key must be available in a line edit</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_key</span><span class="p">:</span>
                <span class="c1"># create line edit for configuration key</span>
                <span class="n">widget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLineEdit</span><span class="p">(</span><span class="n">config_key</span><span class="p">)</span>
                <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">addWidgetToLayout</span><span class="p">(</span><span class="n">config_grid</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

                <span class="c1"># listen to callback</span>
                <span class="n">widget</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">configKeyChanged</span><span class="p">)</span>

            <span class="c1"># configuration level 1 =&gt; simple configuration</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_level</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># add configuration</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addConfigurationSimple</span><span class="p">(</span><span class="n">config_list</span><span class="p">)</span>

            <span class="c1"># configuration level 2 =&gt; sub-configurations</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_level</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c1"># create push button for adding a sub-configuration</span>
                <span class="n">push_button</span> <span class="o">=</span> <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">addPushButton</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lay</span><span class="p">,</span> <span class="p">(</span><span class="n">row_start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_grid_span</span><span class="p">),</span> <span class="s2">&quot;Add sub&quot;</span>
                <span class="p">)</span>

                <span class="c1"># add push button to group button</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">button_group_add</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span>
                    <span class="n">push_button</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="c1"># loop on sub-configurations</span>
                <span class="k">for</span> <span class="n">config_sub_list</span> <span class="ow">in</span> <span class="n">config_list</span><span class="p">:</span>
                    <span class="c1"># add sub-configuration</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">addConfigurationSimple</span><span class="p">(</span><span class="n">config_sub_list</span><span class="p">)</span>

            <span class="c1"># update index of the row in the grid where to add the</span>
            <span class="c1"># configuration grid</span>
            <span class="n">row_start</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># update configuration dictionary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config_dict</span><span class="p">)</span></div>


<div class="viewcode-block" id="Configuration.configKeyChanged"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration.configKeyChanged">[docs]</a>    <span class="k">def</span> <span class="nf">configKeyChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback method for updating configuration key, as well as those of the</span>
<span class="sd">        children configurations, when it is edited in the QLineEdit</span>

<span class="sd">        Connected to the signal ``textChanged`` of the instances of</span>
<span class="sd">        QtWidgets.QLineEdit created in :meth:`.addConfiguration`.</span>

<span class="sd">        It sets the attribute :attr:`.dict` and the configuration</span>
<span class="sd">        dictionary of the children configurations.</span>

<span class="sd">        :param text: updated configuration key</span>
<span class="sd">        :type text: str</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># get index of the changed configuration grid</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">config_grid</span><span class="o">.</span><span class="n">itemAtPosition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">config_grid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span>
        <span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="c1"># get original configuration key</span>
        <span class="n">config_key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">ind</span><span class="p">]</span>

        <span class="c1"># set configuration dictionary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDictionary</span><span class="p">()</span>

        <span class="c1"># loop on children configuration</span>
        <span class="k">for</span> <span class="n">child_config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children_configuration_list</span><span class="p">:</span>
            <span class="c1"># check if original configuration key is in child configuration</span>
            <span class="c1"># dictionary</span>
            <span class="k">if</span> <span class="n">config_key</span> <span class="ow">in</span> <span class="n">child_config</span><span class="o">.</span><span class="n">dict</span><span class="p">:</span>
                <span class="c1"># loop on configuration group boxes</span>
                <span class="k">for</span> <span class="n">child_config_group_box</span> <span class="ow">in</span> \
                        <span class="n">child_config</span><span class="o">.</span><span class="n">config_group_box_list</span><span class="p">:</span>
                    <span class="c1"># check group box title</span>
                    <span class="k">if</span> <span class="n">child_config_group_box</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="o">==</span> <span class="n">config_key</span><span class="p">:</span>
                        <span class="c1"># set group box title with new text</span>
                        <span class="n">child_config_group_box</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

                <span class="c1"># set child configuration dictionary</span>
                <span class="n">child_config</span><span class="o">.</span><span class="n">setDictionary</span><span class="p">()</span></div>


<div class="viewcode-block" id="Configuration.deleteConfiguration"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration.deleteConfiguration">[docs]</a>    <span class="k">def</span> <span class="nf">deleteConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback method for deleting a (sub-)configuration</span>

<span class="sd">        Connected to the signal buttonClicked[int] of</span>
<span class="sd">        :attr:`.button_group_del`.</span>

<span class="sd">        This method updates the following attributes:</span>

<span class="sd">        - :attr:`.dict`</span>
<span class="sd">        - :attr:`.config_grid_list`</span>
<span class="sd">        - :attr:`.config_group_box_list`</span>
<span class="sd">        - :attr:`.nb_sub_list`</span>

<span class="sd">        :param button_id: index of the button that has been pushed</span>
<span class="sd">        :type button_id: int</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># update configuration dictionary with current values filled in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDictionary</span><span class="p">()</span>

        <span class="c1"># get flatten index of the (sub-)configuration grid to delete</span>
        <span class="n">config_id</span><span class="p">,</span> <span class="n">sub_config_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">btn_id_to_config_id</span><span class="p">[</span><span class="n">button_id</span><span class="p">]</span>

        <span class="c1"># get configuration key corresponding to the configuration grid to</span>
        <span class="c1"># delete</span>
        <span class="n">config_key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">config_id</span><span class="p">]</span>

        <span class="c1"># check level</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_level</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># delete configuration from video dictionary</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">config_key</span><span class="p">]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_level</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># delete sub-configuration</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_sub_list</span><span class="p">[</span><span class="n">config_id</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">config_key</span><span class="p">][</span><span class="n">sub_config_id</span><span class="p">]</span>

            <span class="c1"># delete whole configuration</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">config_key</span><span class="p">]</span>

                <span class="c1"># loop on children configurations</span>
                <span class="k">for</span> <span class="n">child_config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children_configuration_list</span><span class="p">:</span>
                    <span class="c1"># check if child configuration must be deleted</span>
                    <span class="k">if</span> <span class="n">config_key</span> <span class="ow">in</span> <span class="n">child_config</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="k">del</span> <span class="n">child_config</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">config_key</span><span class="p">]</span>
                        <span class="n">child_config</span><span class="o">.</span><span class="n">resetDisplay</span><span class="p">()</span>

        <span class="c1"># reset display</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resetDisplay</span><span class="p">()</span></div>


<div class="viewcode-block" id="Configuration.resetDisplay"><a class="viewcode-back" href="../../../APIreference/configuration/Configuration/index.html#visiannot.configuration.Configuration.Configuration.resetDisplay">[docs]</a>    <span class="k">def</span> <span class="nf">resetDisplay</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes the configuration grids in :attr:`.config_grid_list`) and</span>
<span class="sd">        replaces them with :attr:`.ConfigurationWindow.dict`</span>

<span class="sd">        This method updates the following attributes:</span>

<span class="sd">        - :attr:`.config_grid_list`</span>
<span class="sd">        - :attr:`.config_group_box_list`</span>
<span class="sd">        - :attr:`.nb_sub_list`</span>

<span class="sd">        :author: Raphael Weber</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># delete the configuration widgets</span>
        <span class="n">ToolsPyQt</span><span class="o">.</span><span class="n">deleteWidgetsFromLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lay</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_level</span>
        <span class="p">)</span>

        <span class="c1"># reset the list of configuration grids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_grid_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># reset the list of configuration group boxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_group_box_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># reset the list of number of sub-configurations for each configuration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb_sub_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">btn_id_to_config_id</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># display the values of the configuration dictionary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">)</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020-2021, Universit√© Rennes 1

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>